% $Id$
% arara: lualatex
% arara: biber
% arara: makeindex: {style: style.ist}
% arara: lualatex
% arara: makeindex: {style: style.ist}
% arara: lualatex
% arara: clean:{extensions:[aux,bbl,bcf,blg,fdb_latexmk,fls,idx,
% arara: --> ilg,ind,loc,lof,log,loos,lop,loq,lot,mw,mw.mw,
% arara: --> out,run.xml,toc]}
% doris beginfolding in vim
% !TEX TS-program = lualatexmk
% !BIB TS-program=biber
% doris: obige zeilen f"ur TeXShop aufm mac
% !Mode:: "TeX:DE"    % Setting document mode and submode for WinEdt
% ............................................................................
%        MAIN- or STARTING-Datei für das CrypTool-Buch-Dokument
%
% Comments: - Add (lengthy) comment only into this German version!
%           - Kommentare, die sich NICHT NUR auf die englische Version beziehen,
%             nur in die deutschen TeX-Dateien.
%
% kl"aren mit Dt-Lehrer: abelsche Gruppe, aber Boolesche Funktion?
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%
% Housekeeping:
% - Use  %-%-%-%-%-%-%  TEST_CURRENT  %-%-%-%-%-%-%-%  as long as working on a current problem.
% be_2016-07-18: - If implemented: CT2 and JCT mentioned as well as CT1.
% be_2016-07-20: - Consistent names for chapter labels and hypertargets, all start with "Chapter_"
% Remark concerning LaTeX:
% 1) Appearing of black boxes: They are only created if you have the draft option set.
%    \documentclass[11pt,a4paper,draft]{report}
%                                ^^^^^
%    It will go away if you delete this - and just appear as a warning in texfile.log
%    such as  Overfull \hbox (38.36009pt too wide)  in paragraph at lines 16--30
% 2) Black boxes kamen auch nach Einfügen der Referenzen:
%    http://tex.stackexchange.com/questions/171999/overfull-hbox-in-biblatex
%    --> Load \usepackage[final]{microtype}
%        or try  \emergencystretch=1em  or try  \begin{tolerant}{3000}
% 3)
%
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%
% Todos for later: Doris?
% =======================
% 1) In code ifdefs machen, dass wenn draft (in documentclass) gesetzt, dass dann
%    Verschiedenes anders, aber automatisch:
%    - \errorcontextlines=200  --> Erh. mehr Kontextinfo um auftretende Fehler herum.
%    - \tracingstats=2
%    - (vllt nur einen Gesamtindex am Ende, dass es schneller compiliert?)
%    - ...
% 5) Nice-to-have: Berechnte Zeilenzahl in Tabellen-Unterschrift bringen
% 8) Echte noch vorhandene Fehler suchen:
%    a) Fehler_01: Avoid black box e.g. at end chap 4 in URL (only in English, page 223)
%    b) Fehler_02: Im Contents (page V) wird bei beiden Gesamtliteraturverzeichnissen
%       eine falsche Seitenzahl angezeigt - das Ende, also die letzte Seite der
%       Bibliography, statt die erste Seite davon. Aber wenn man auf den Eintrag
%       im Contents klickt, kommt man auf die richtige Seite:
%       D: (522 + 537) statt (508 + 523).
%       E: (506 + 521) statt (493 + 507).
% ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
% endfolding

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper,11pt,oneside,english,ngerman]{book}
%\documentclass[a4paper,11pt,oneside,english,ngerman,draft]{book}
% the order ngerman-english doesn't seem to matter.

\newcommand*{\indexsection}[1]{\markright{#1}}


\usepackage[ngerman]{babel}
\usepackage{datetime} % To distinguish often compiled draft versions


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%---------------abmessungen textbreite etc.

%\usepackage{fullpage}%doris: prefer geometry; bottom margin changes, left/right don't change
\usepackage[margin=2.54cm]{geometry}

\overfullrule=5pt % uncomment to mark overfull boxes
%endfolding abmessungen

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-------fonts, encoding etc.
\usepackage{fontspec}%f"ur lualatex, statt fontec wie bei pdflatex
\setmainfont[Path=/Library/fonts/,Extension=.otf]{STIXGeneral}
\usepackage[final]{microtype}
%\usepackage[T1]{fontenc} %BERM2: bitciphers.tex used T1.
                % Ohne T1 wurden dort \dh und \textperthousand nicht erkannt.
                % Die Hinzunahme von T1 (soll eigentlich Umbrüche verbessern)
                % erzeugt aber ein paar zusätzliche schwarze Balken (z.B. bei
                % "Der DES-Algorithmus ist" in cryptomethods.text im Deutschen,
                % und bei der Trennung von "straddling checker-board" in 2.2.1 im Englischen.
% Statt T1 als Package zu inkludieren, nur die wirklich benötigten Sonderzeichen definiert.
\DeclareTextSymbolDefault{\dh}{T1}
\DeclareTextSymbolDefault{\textperthousand}{T1}
\usepackage{eurosym}%Necessary for  symbol in chap 8.3.1 bitcipers.tex (not in en version)

\usepackage{ae}%16xxxxxxxxxxxxxx Neu wegen dlog.tex% doris: iwas mit fonts
%endfolding fonts etc.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%------bibliographie
%\usepackage[style=alphabetic,backend=biber,refsection=chapter,sorting=nyt]{biblatex}
\usepackage[style=alphabetic,backend=biber,sorting=nyt,maxbibnames=99]{biblatex}
\addbibresource{references-new.bib}
\usepackage{csquotes}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%------index
\usepackage{makeidx}  % Alternativ evtl. \usepackage{imakeidx} (bemerkte keinen Unterschied) --> Alphabetheader wahrscheinlich möglich!
% definiert 2 befehle: see und printindex
\makeindex
% \makeindex[columns=3, title=Alphabetical Index] %%% TodoTodo_Nice-to-have-only: Alphabetzeichen als Header im Index. Tat nicht! --> Siehe usepackage{imakeidx}
%endfoldingindex

%%%beginfolding%%%%%%%%%%%%%%%%%%%%%%%%%%%%----mathe, symbole
\usepackage{amsmath}
\usepackage{amssymb,amscd,latexsym}   %BERM2: added for biciphers.tex
%amscd commutative diagrams; %latexsym some additional characters
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{wasysym}%Necessary for permil (promille) symbol in chap 8.3.7 bitcipers.tex
%doris beginfolding iwas mit promille und wasysym
% First \textperthousand was used for the promille symbol in bitcipers.tex.
% As a black box appeared after a %, I tried \usepackage{textcomp}.
% However, then 2 warnings came up at \copyright:
%   script-de.tex --- 326
%   LaTeX Font Warning: Font shape `TS1/aer/m/n' undefined using `TS1/cmr/m/n' instead
%                       for symbol `textcopyright' on input line 326.
% Info:
% \textperthousand only works in text mode, not in math mode.
% \permil from the package wasysym, works in both text mode as in math mode.
%endfolding
%endfoldingmathe

%%%%%%%%%%%%%beginfolding%%%%%%%%%%%%%%%%%%%----graphik
\usepackage{color}   %BERM2: added for biciphers.tex
\providecommand{\DIFadd}[1]{{\protect\color{blue}\uwave{#1}}} %DIF PREAMBLE%16xxxxxxxxxxxxxx
\providecommand{\DIFdel}[1]{{\protect\color{red}\sout{#1}}}                      %DIF PREAMBLE%16xxxxxxxxxxxxxx
\usepackage{rotating}
\usepackage{graphicx} %BE_20180715
\usepackage{tikz,tikz-cd} %16xxxxxxxxxxxxxx WIRKLICH NOETIG?
\tikzset{ampersand replacement=\&} %DIF > %16xxxxxxxxxxxxxx
\usepackage{pdfpages}   % SR_2009: added new cover
\usepackage{subfig}
\usepackage{wrapfig}%16xxxxxxxxxxxxxx WIRKLICH NOETIG?
%endfoldinggraphik

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%beginfolding%%%%%%%%%%%%-----floats
\usepackage{float}% for option >>here<< and for defining new floats
\floatstyle{boxed}  % This is necessary to have borders around the Zitate.
                    % After the ctsquote def overruled by \floatstyle{ruled} ?
\newfloat{ctsquotefloat}{H}{loq}   % ctsQuotes-from-Books, List-of-Quotes
\floatname{ctsquotefloat}{Zitat}   % ctsQuotes with centering
\newenvironment{ctsquote}{\begin{ctsquotefloat}\center}{\end{ctsquotefloat}}
\floatstyle{ruled}

\newfloat{sagecode}{!ht}{loc}[chapter]
\floatname{sagecode}{SageMath-Beispiel}

\newfloat{opensslcode}{!ht}{loos}[chapter]
\floatname{opensslcode}{OpenSSL-Beispiel}

\newfloat{cryptoprocedure}{!ht}{lop}[chapter]
\floatname{cryptoprocedure}{Krypto-Verfahren}
%endfoldingfloats

%%%%%%%%%%beginfolding%%%%%%%%%%%%%%-----layout, z.B. boxen, listen, linien
\raggedbottom
\pagestyle{headings}
%\chapter[toc version]{doc version}\chaptermark{running-header version}
\usepackage{fancybox} %16xxxxxxxxxxxxxx
\usepackage{paralist}  %BE_2012: eliminate space after end{itemize} worked with compactitem
\usepackage{verse}    %BE_Feb2013: To use \settowidth{\versewidth}{xxx}
\usepackage{shorttoc}
\RequirePackage[normalem]{ulem} %DIF PREAMBLE%16xxxxxxxxxxxxxx%underline nicely
\usepackage{ragged2e} % be_2016-08-04: ragged margin with hyphenation w/ blackbox in index (needed only for index in de)
%endfoldinglayout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-----code
\usepackage{fancyvrb} % for verbatim; VerbatimFootnotes command after preamble allows
%verbatim text in footnotes

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%---------tabellen
\usepackage{arydshln} %BE_Jan2013: To use hdashline

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%----------- footnotes
\usepackage[flushmargin]{footmisc}

%%beginfolding%%%%%%%%%%%%%%%%%%%%%%%%%%%-----not needed anymore
%\usepackage{myThanks} %\usepackage{thumbpdf} %\usepackage[T1]{fontenc} %\usepackage{times}
%\usepackage{pslatex} %\usepackage{ae,aecompl}
% Rahmen um Boxen, die auch mehrzeilig sein können (siehe Euler-Phi-Def.)
% \usepackage{framed}  %% Nicht gebraucht, da man dafür auch \parbox innerhalb von \fbox aufrufen kann.
%\RequirePackage{color}\definecolor{RED}{rgb}{1,0,0}\definecolor{BLUE}{rgb}{0,0,1} %DIF PREAMBLE%16xxxxxxxxxxxxxx% doris: hab ich rausgeschmissen, da es nirgends gebraucht wird!
%endfolding

%doris beginfolding iwas mit nameref
% -------------
%BE_2016Jun: \StrSubstitute{abcde}{d}{D}  (could be used together with hyperref)
% \usepackage{xstring,xifthen}
%To reduce the number of hyperlink related 'pdfTeX warning's we could use options
% pdfpagelabels, plainpages=false and, hyperfootnotes=false,
% and place hyperref after float and after mykeidx!
% Option debug helps finding problems.
%https://viaverdepaisagismo.com.br/index.cgi/ar/00/http/tex.stackexchange.com/questions/296643/how-to-use-nameref-with-xstring-package-to-check-string-length
% http://tex.stackexchange.com/questions/178610/replacing-substrings-by-linebreaks
% Within \StrSubstitute or \StrLen we need an expandable version of \nameref (%BE_2016Jun):
\makeatletter
\newcommand{\getnamereftext}[1]{%
  \@ifundefined{r@#1}{}{%
    \unexpanded\expandafter\expandafter\expandafter{%
      \expandafter\expandafter\expandafter\@thirdoffive\csname r@#1\endcsname
    }%
  }%
}
\makeatother
%endfolding


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%------------ misc
%\usepackage{morewrites}% Neu wegen "message {No room for a new \string #" nach Hinzufügen von \lostof{opensslcode}
%brauchen wir nicht mehr mit luatex
\usepackage{ifthen}

%beginfolding%%%%%%%%%%%%%%%%----------user-defined-commands,envir., counters etc.
\newcommand{\ignoreoutput}[1]{\setbox0\vbox{\everypar{}#1}}

\newtheorem{definition}{Definition}[section]
\newtheorem{satz}{Satz}[section]

\renewenvironment{proof}[1]{\noindent\textbf{Beweis #1} \\}{\hfill$\Box$\par}
\newenvironment{Beweis}[1]{\noindent\textbf{Beweis #1} \\}{\hfill$\Box$\par}
\newenvironment{example}[1]{\noindent\textbf{Beispiel#1}}{}
\newenvironment{remark}[1]{\noindent\textbf{Bemerkung#1}}{}
\newenvironment{ Latex_Create-Closed-Dummy-Environ }{}{}
%seems to be necessary for some graphics in bitcipher chapter

\setcounter{tocdepth}{4}    % Das Inhaltsverzeichnis wird vier Ebenen tief (Default ist 3).
\setcounter{secnumdepth}{4} % Nummerierung auch bei subsubsection

%what is the use of those????
\providecommand{\DIFaddbegin}{} %DIF PREAMBLE%16xxxxxxxxxxxxxx
\providecommand{\DIFaddend}{} %DIF PREAMBLE%16xxxxxxxxxxxxxx
\providecommand{\DIFdelbegin}{} %DIF PREAMBLE%16xxxxxxxxxxxxxx
\providecommand{\DIFdelend}{} %DIF PREAMBLE%16xxxxxxxxxxxxxx
\providecommand{\DIFaddFL}[1]{\DIFadd{#1}} %DIF PREAMBLE%16xxxxxxxxxxxxxx
\providecommand{\DIFdelFL}[1]{\DIFdel{#1}} %DIF PREAMBLE%16xxxxxxxxxxxxxx
\providecommand{\DIFaddbeginFL}{} %DIF PREAMBLE%16xxxxxxxxxxxxxx
\providecommand{\DIFaddendFL}{} %DIF PREAMBLE%16xxxxxxxxxxxxxx
\providecommand{\DIFdelbeginFL}{} %DIF PREAMBLE%16xxxxxxxxxxxxxx
\providecommand{\DIFdelendFL}{} %DIF PREAMBLE%16xxxxxxxxxxxxxx

%define counter rownu beginfolding
\makeatletter
\providecommand{\rowno}[1][__empty__]{%%% used for col 1 of prime records table
    \ifthenelse{\isundefined{\c@rowno}}{%
        \newcounter{rowno}}{}%
    \ifthenelse{\equal{#1}{__empty__}}{%
        \stepcounter{rowno}% increases counter, see https://en.wikibooks.org/wiki/LaTeX/Counters
        }{%
        \setcounter{rowno}{#1}%
        }%
    \therowno%
}
\makeatother
%rowno is only used in chapter >>primes<< %endfolding

\setlength{\fboxrule}{.5mm}
\setlength{\fboxsep}{1.75mm}
\setlength{\footnotesep}{6pt}
\addtolength{\footskip}{8pt}
% \setlength{\footskip}{4cm}
%endfoldinguserdefined

% Define title %doris: please let's do it now from scratch later! beginfolding
\title{%
% be_Wished to enlarge only the main title, however \HUGE not available,
	{\Huge Das CrypTool-Buch:\\[20pt]
	       {\bf Kryptographie lernen und anwenden\\[15pt]
                mit CrypTool und SageMath}} \\[35pt]
	{\LARGE Hintergrundmaterial und Zusatzinformationen\\
	 zum freien E-Learning Krypto-Programm CrypTool\\[5pt]
	 (Kryptographie, Mathematik und mehr)} \\[35pt]
	%{\large 12. Auflage}
	 {\large 12. Auflage --  {\bf Draft-Version} (\settimeformat{hhmmsstime}\currenttime)}
}%endfolding

\author{% beginfolding
	{\LARGE Prof.\ Bernhard Esslinger (Mitautor und Herausgeber)}\\[10pt]
	{\LARGE und das CrypTool-Team, 1998-2019}\\[10pt]
%	{\LARGE Frankfurt am Main}\\*[15pt]
	\url{www.cryptool.org}
}%endfolding

%%beginfolding%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%-------hyperref &co
\usepackage{xurl}
%the following 3 counters have to be set manually, because
%biblatex does not understand xurl, but we want to avoid bad
%boxes resulting from not broken urls in the bib
\setcounter{biburllcpenalty}{1} \setcounter{biburlucpenalty}{1} \setcounter{biburlnumpenalty}{1}
\usepackage[colorlinks=true,linkcolor=blue,citecolor=blue,urlcolor=cyan, %% BE_2018-07 black->cyan,
bookmarksnumbered=true,pdfpagelabels,plainpages=false,%
hyperfootnotes=false]{hyperref}

%endfoldinghyperref

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
%test
%\end{document}

\includepdf[pages=1]{figures/coverv1_de.pdf}  % ab 2017 nur eine Auflösung und kein Querbalken
\VerbatimFootnotes
%doris: manual adjustment of look of footnotes: get rid of!%beginfolding
% space between text and footnote
% \renewcommand{\footnoterule}{\parindent0cm\rule{13cm}{.1pt}\vspace{.2cm}}
% Formatierung der Fußnoten
\renewcommand\footnoterule{
\vspace{2em}%   <-- one line space between text and footnoterule
% \kern-3\p@
\hrule width .4\columnwidth
\vspace{4pt}
% kern 2.6\p@
}%endfolding
\frontmatter % Ab hier beginnt Seitennummerierung mit römischen Ziffern
\maketitle

%beginfoldingersteseiten
% Vergleichbar zur Nutzung von Texten aus der Wikipedia (=GNU Free Documentation Licence, GFDL)
\begin{quote}
Dies ist ein freies Dokument, d.h. Inhalte des Dokuments können kopiert und
verbreitet werden, auch zu kommerziellen Zwecken.\\
Im Gegenzug sind Autor, Titel und die CrypTool-Webseite (\url{www.cryptool.org}) zu
nennen. Selbstverständlich darf aus dem CrypTool-Buch, genau wie aus jedem
anderen Werk auch, zitiert werden. \\
Darüber hinaus unterliegt dieses Dokument der GNU-Lizenz für freie
Dokumentation.

%   Copyright \textcopyright{} 1998--2018 Bernhard Esslinger and the    %% Geht beides.
    Copyright \copyright{} 1998--2018 Bernhard Esslinger and the
    CrypTool Team. Permission is granted to copy,
    distribute and/or modify this document under the terms of the GNU
    Free Documentation License, Version 1.3 or any later version
    published by the Free Software Foundation (FSF). A copy of
    the license is included in the section entitled
    \hyperlink{appendix-GNU-fdl}{``GNU Free Documentation License''}.

    Dies beinhaltet auch den Code für die SageMath-Beispiele in diesem Dokument.
\end{quote}



\vspace{70pt}\noindent Zum Referenzieren per bibtex:
% Referenzart: book
% Notwendige Felder: author oder editor, title, publisher, year
% Optionale Felder: volume oder number, series, address, edition, month, note, isbn
%doris: wozu sind bei title die div. Buchstaben extra geklammert???
\begin{Verbatim}% Verbatim instead of verbatim from package fancyvrb
[fontsize=\footnotesize]
@book{Esslinger:ctb_2018,
  editor    = {Bernhard Esslinger},
  title     = {{D}as {C}ryp{T}ool-{B}uch: {K}ryptographie lernen
               und anwenden mit {C}ryp{T}ool und {S}age{M}ath},
  publisher = {CrypTool-Projekt},
  edition   = {12},
  year      = {2018}
}
\end{Verbatim}



\vfill

\noindent
Quelle Coverfoto: \url{www.photocase.com}, Andre Günther\\
Schriftsatz-Software: \LaTeX\\
Versionsverwaltungs-Software: Subversion
%endfoldingersteseiten

\input{chapters/overviewcontent.tex} % Überblick über Inhalt des CT-Buches soll vor toc

\newpage
\pdfbookmark[0]{Kurzinhaltsverzeichnis}{ShortContents}
\shorttoc{Kurzinhaltsverzeichnis}{0}
\clearpage\phantomsection
\pdfbookmark[0]{\contentsname}{Contents}
\tableofcontents

\newpage \normalsize

% Setting the default for the vertical distance before a paragraph as distinguished variable
% doris: uuuaaaaahhhhhh! not like this!!!!!
\newcounter{mycounterDefaultParskip} \setcounter{mycounterDefaultParskip}{4}
\parskip \value{mycounterDefaultParskip} pt

%%% 2) Überall im Text sollen die automatisch erzeugten alpha-Referenzen angezeigt werden.
%doris: was sind alpha-Referenzen??
%xy%%_17-01-19: Introduced
%LaTeX var CTBChapName to have a specific headline for the chapter bibliography
%doris: diese renewcommands wird man eventuell nicht mehr brauchen??? sie sind im Deutschen eh nicht angebracht, keiner rafft das!
\renewcommand{\bibname}{Literaturverzeichnis \CTBChapName{}}  %xy%%_17-01-19:
\newcommand{\CTBChapName}{(Intro)}

\input{chapters/introduction.tex} % Working together of Book and Programm
\mainmatter % Ab hier beginnt Seitennummerierung mit arabischen Ziffern
%doris: w"urde ich nicht machen, denn dann stimmen die pdf-seitenzahlen, die im
%pdf-viewer angezeigt werden, nicht mit den Seitennummern auf den seiten "uberein


\input{chapters/cryptomethods.tex}
\renewcommand{\CTBChapName}{(Kap. PaP)}
\input{chapters/paper_and_pencil.tex}
\renewcommand{\CTBChapName}{(Kap. Primes)}
\input{chapters/primes.tex}
\renewcommand{\CTBChapName}{(Kap. NT)}
\input{chapters/numbertheory.tex}
\renewcommand{\CTBChapName}{(Kap. ModernCrypto)}
\input{chapters/moderncryptography.tex}
\renewcommand{\CTBChapName}{(Kap. DigSig)}
\input{chapters/digitalsignatures.tex}
\renewcommand{\CTBChapName}{(EllCurves)}
\input{chapters/ellipticcurves.tex}
\renewcommand{\CTBChapName}{(BitCiphers)}
\input{chapters/bitciphers.tex}
\renewcommand{\CTBChapName}{(Kap. HE)}
\input{chapters/homomorphicencryption.tex}
\renewcommand{\CTBChapName}{(DLogFact)}
\input{chapters/dlog-factoringdead.tex}
\renewcommand{\CTBChapName}{(Crypto2020)}
\input{chapters/crypto2020.tex}

%begin app to end app beginfolding
% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\begin{appendix}
\newpage
\hypertarget{appendix-start}{}\label{s:appendix-start}
\chapter{Anhang}
    \begin{itemize}%doris: what??? wieso nicht enumerate???
      \item[1] \hyperlink{appendix-menu-overview-CT1}{CrypTool-1-Menübaum}
      \item[2] \hyperlink{appendix-template-overview-CT2}{CrypTool-2-Vorlagen}
      \item[3] \hyperlink{appendix-function-overview-JCT}{JCrypTool-Funktionen}
      \item[4] \hyperlink{appendix-function-overview-CTO}{CrypTool-Online-Funktionen}
      \item[5] \hyperlink{appendix-movies}{Filme und belletristische
                          Literatur mit Bezug zur Kryptographie}
      \item[6] \hyperlink{appendix-Learn-NT}
                         {Lernprogramm Elementare Zahlentheorie}
      \item[7] \hyperlink{appendix-using-sage}
                         {Kurzeinführung in das Computer-Algebra-System SageMath}
      \item[8] \hyperlink{appendix-authors}{Autoren des CrypTool-Buchs}
    \end{itemize}
\renewcommand{\CTBChapName}{(Appendix\_Menus)}
\input{chapters/menus.tex}
\renewcommand{\CTBChapName}{(Appendix\_LearnTool)}
\input{chapters/movies.tex}
\renewcommand{\CTBChapName}{(Appendix\_Sage)}
\input{chapters/what-is-sage.tex}
\renewcommand{\CTBChapName}{(Appendix\_Authors)}
\input{chapters/authors.tex}
\end{appendix}
%endfolding

\renewcommand{\CTBChapName}{(Appendix gnu-fdl)}
\input{chapters/gnu-fdl-1.3.tex}

%listoffigures, tables, cryptoprocedures, quotes beginfolding
% ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\begingroup  % Warum gerade diese drei Listen gruppiert?
  % remove extra vertical space from \listoffigure and \listoftables so that
  % it looks similar to \listof{sagecode}
  \setlength{\parskip}{0pt}  %% Im ENGLISCHEN -- Alternative ?: \renewcommand*{\addvspace}[1]{}

  % be_2018-05-02: Taking \phantomsection away from here causes link in ToC to move to previous page.
  \clearpage\phantomsection
  \addcontentsline{toc}{chapter}{\listfigurename}
  \listoffigures

  \clearpage\phantomsection
  \addcontentsline{toc}{chapter}{\listtablename}
  \listoftables

  \clearpage\phantomsection
  \addcontentsline{toc}{chapter}{Verzeichnis der Krypto-Verfahren mit Pseudocode}
  \listof{cryptoprocedure}{Verzeichnis der Krypto-Verfahren mit Pseudocode}
\endgroup

\clearpage\phantomsection
\addcontentsline{toc}{chapter}{Verzeichnis der Zitate}
\listof{ctsquotefloat}{Verzeichnis der Zitate}
\index{Zitate}
\label{sc:List-of-Quotes}
%endfolding

%liste openssl etc. beginfolding
% Zur Fehlermeldung vgl https://www.ntg.nl/doc/fairbairns/newfaq.pdf, #228:
%                       Läuft mir damit eine Registerzahl über? Welche?
% http://tex.stackexchange.com/questions/289734/special-package-combination-gives-no-room-for-new-write:
% The solution was to use \usepackage{morewrites} since basically any of the packages already loaded
% there grabs at least one (write) file handle, but the number of file handles is restricted to
% 16 registers only, unless morewrites is loaded.
 \clearpage\phantomsection%%% Zeile \listof verursachte den Error \e@ch@ck ...message {No room for a new \string #4}
 \addcontentsline{toc}{chapter}{Verzeichnis der OpenSSL-Beispiele}
 \listof{opensslcode}{Verzeichnis der OpenSSL-Beispiele}
 \index{OpenSSL!Beispiel}
 \label{sc:List-of-OpenSSL-Code-Examples}
%endfolding

%liste sagemath etc. beginfolding
\clearpage\phantomsection
\addcontentsline{toc}{chapter}{Verzeichnis der SageMath-Programmbeispiele}
\listof{sagecode}{Verzeichnis der SageMath-Programmbeispiele}
\index{SageMath!Programmbeispiele}
\label{sc:List-of-Sage-Code-Examples}


\vspace{30pt}
\begin{itemize}
  \item Der Quellcode der SageMath-Beispiele in diesem Skript wird in Form von
        SageMath-Programmdatei"-en mit dem CT1-Setup-Programm ausgeliefert.
        Die Beispiele in einem Kapitel sind jeweils in einer Datei zusammen gefasst.\\
        Nach der Installation von CrypTool~1 \index{CT1} finden Sie
        die SageMath-Beispiele im Unterverzeichnis \verb#sagemath# in den folgenden
        4 Dateien:\\\\%%%% TODOTODO: more files und nicht nur per CT1 --> evtl. nach Github !
        - SageMath-Samples-in-Chap01.sage \\
        - SageMath-Samples-in-Chap02.sage \\
        - SageMath-Samples-in-Chap03.sage \\
        - SageMath-Samples-in-Chap04.sage
  \item Alle Beispiel wurden mit der SageMath-Version 5.3 (Release Date 2012-09-08) getestet.
\end{itemize}   % xxxxxxxxxxxxxx Weitere Beispiele ergänzen !  % TODOTODO: Update.
%endfolding


%bibliographie beginfolding
%------------------------------------------------------------------------------
%\nocite{*}
\printbibliography[heading=bibintoc,
title={Gesamtliteraturverzeichnis}]

%endfolding

%index beginfolding
%------------------------------------------------------------------------------
\clearpage\phantomsection
% In order to have a better overview in the index, we used \see...
% So e.g. use only \index{CT1}, as "CrypTool 1" refers to it.
% - Info:
%   - http://tex.stackexchange.com/questions/86646/indexing-subentries-and-see-also
%     Per neu zu def \index also neue Zeile am Ende von Entry 1, das auf Entry 2 verweist.
%   - Um auf Subentry zu verweisen, muss man das Ziel anders schreiben: Also nicht
%     see{Fermat!letzter Satz}, sondern see{Fermat, letzter Satz}.
%     http://tex.stackexchange.com/questions/186019/makeindex-and-see-subentry
  \index{Primzahlzerlegung|see{Faktorisierung}}

  \index{gpg|see{GnuPG}}
  \index{One-Time-Pad|see{OTP}}
  \index{PRNG|see{Zufallsgenerator}}
  \index{Pseudozufallsgenerator|see{Zufallsgenerator}}
  \index{Schlüsselaustausch!Diffie-Hellman|see{Diffie-Hellman}}
  \index{ECC|see{elliptische Kurve}}
  \index{Triple-DES|see{DES, Triple-DES}}

  \index{Fermat!großer Satz|see{Fermat, letzter Satz}}
  \index{Fermat!zweiter Satz|see{Fermat, letzter Satz}}
  \index{großer Satz|see{Fermat, letzter Satz}}
  \index{zweiter Satz|see{Fermat, letzter Satz}}
  \index{letzter Satz|see{Fermat, letzter Satz}}
  \index{kleiner Satz|see{Fermat, kleiner Satz}}

  % \index{MysteryTwister C3|see{MTC3}|see{Krypto-Wettbewerb}}  % Das geht nicht, zeigt nur "siehe MTC3".
  \index{MysteryTwister C3|see{MTC3}}
  % \index{MysteryTwister C3|see{Krypto-Wettbewerb}}  Raus, da 2 Verweise nicht schön, und vor allem
  %            werden sie alphabetisch geordnet und nach "siehe Krypto-Wettbewerb" ist eine Blackbox.
  \index{Challenge|see{Krypto-Wettbewerb}}
  % \index{Cipher-Challenge|see{Krypto-Wettbewerb}}  Raus, führt trotz RaggedRight zu Blackbox.
  \index{CrypTool~1|see{CT1}}  %% So \index{CrypTool~1} is no more needed, only \index{CT1}.
  \index{CrypTool~2|see{CT2}}
  \index{JCrypTool|see{JCT}}
  \index{CrypTool-Online|see{CTO}}

  \index{Phi-Funktion|see{Eulersche Phi-Funktion}}
  \index{Fast Fourier Transformation|see{FFT}}
  \index{FSR|see{Schieberegister}}
  \index{rückgekoppeltes Schieberegister|see{Schieberegister}}
  \index{PQC|see{Post-Quantum-Computing}}

%% be_2016-08-04: Da es 4 blackboxes im Index gab (nur dt.), ragged2e und RaggedRight --> half.
%% Siehe: http://tex.stackexchange.com/questions/63006/overfull-hbox-from-printindex
%%        http://tex.stackexchange.com/questions/97196/how-to-avoid-bad-boxes-in-the-index
%%  - warning "overfull hbox". With the class option draft the overfull box is marked with an black box.
%%  \usepackage{index,lipsum,lmodern}
%%  \usepackage{ragged2e}
{% start group
  \addcontentsline{toc}{chapter}{Index}
  \RaggedRight  % be_2016-08-04: left-justified setting w/ blackbox in index
  \printindex
}% end group
%endfolding

\newpage %Nice-to-have-TODO_LaTeX_Doesn't seem to create an empty page at the end.
\newpage

\end{document}

