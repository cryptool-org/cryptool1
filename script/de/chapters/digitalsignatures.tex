% $Id$
% ...........................................................................
%                  D I G I T A L E  S I G N A T U R E N
% ...........................................................................

\newpage
% --------------------------------------------------------------------------
\hypertarget{Chapter_Hashes-and-Digital-Signatures}{}
\section{Hashfunktionen und Digitale Signaturen}
\label{Chapter_Hashes-and-Digital-Signatures}
\index{Signatur!digitale}
(Schneider J. / Esslinger B. / Koy H., Juni 2002; 
Updates: Feb. 2003, Juni 2005)

\vspace{12pt}
Ziel der digitalen Signatur ist es, folgende zwei Punkte zu gew"ahrleisten:
\begin{itemize}
 \item Benutzerauthentizit"at:\index{Authentizit""at!Benutzer-}  \\
      Es kann "uberpr"uft werden, ob eine Nachricht tats"achlich
      von einer bestimmten Person stammt.
 \item Nachrichtenintegrit"at:\index{Nachrichtenintegrit""at}  \\
      Es kann "uberpr"uft werden, ob die Nachricht (unterwegs) 
      ver"andert wurde.
\end{itemize}


Zum Einsatz kommt wieder eine asymmetrische Technik (siehe 
Verschl"usselungsverfahren).
Ein Teilnehmer, der eine digitale Signatur f"ur ein Dokument erzeugen will,
muss ein Schl"usselpaar besitzen. Er benutzt seinen geheimen Schl"ussel,
um Signaturen zu erzeugen, und der Empf"anger benutzt den "offentlichen
Schl"ussel des Absenders, um die Richtigkeit der Signatur zu "uberpr"ufen.
Es darf wiederum nicht m"oglich sein, aus dem "offentlichen den geheimen
Schl"ussel abzuleiten\footnote{%
Mit CrypTool\index{CrypTool} k"onnen Sie ebenfalls digitale Signaturen
erzeugen und pr"ufen: \\
in den Untermen"us des Hauptmen"upunktes 
{\bf Digitale Signaturen / PKI} oder \\
per 
{\bf Einzelverfahren \textbackslash{} RSA-Kryptosystem \textbackslash{}
Signaturdemo (Signaturerzeugung)}.
}.


Im Detail sieht ein \index{Signaturverfahren} {\em Signaturverfahren} 
folgenderma"sen aus: \\
Der Absender berechnet aus seiner Nachricht und seinem geheimen Schl"ussel
die digitale Signatur der Nachricht. Im Vergleich zur handschriftlichen
Unterschrift hat die digitale Signatur den Vorteil, dass die 
Unterschrift auch vom unterschriebenen Dokument abh"angt. Die Unterschriften
ein und desselben Teilnehmers sind verschieden, sofern die unterzeichneten
Dokumente nicht vollkommen "ubereinstimmen. Selbst das Einf"ugen eines
Leerzeichens in den Text w"urde zu einer anderen Signatur f"uhren. Eine
Verletzung der Nachrichtenintegrit"at wird also vom Empf"anger der 
Nachricht erkannt, da in diesem Falle die Signatur nicht mehr zum Dokument
passt und sich bei der "Uberpr"ufung als unkorrekt erweist.

Das Dokument wird samt Signatur an den Empf"anger verschickt. Dieser kann
mit Hilfe des "offentlichen Schl"ussels des Absenders, des Dokuments und
der Signatur feststellen, ob die Signatur korrekt ist.
Da eine Signatur circa so lange ist wie der unmittelbar zu signierende 
Datenstrom, hat das gerade beschriebene Verfahren in der Praxis jedoch einen
entscheidenden Nachteil: Die Signatur ist ungef"ahr genauso lang wie das
eigentliche Dokument. Um den Datenverkehr nicht unn"otig anwachsen zu
lassen und aus Performance-Gr"unden\index{Performance} wendet -- man vor
dem Signieren -- auf das Dokument eine kryptographische 
Hashfunktion\footnote{%
Hashfunktionen\index{Hashfunktion} sind in CrypTool\index{CrypTool}
an mehreren Stellen implementiert.\\
In den Men"us {\bf Einzelverfahren \textbackslash{} Hashverfahren} bzw.
              {\bf Analyse \textbackslash{} Hashverfahren}
haben Sie die M"oglichkeit
% hier die items nicht einr"ucken!
\begin{list}{\textbullet}{\leftmargin10pt\addtolength{\itemsep}{-1.0\baselineskip}}
%\begin{itemize}\addtolength{\itemsep}{-1.0\baselineskip}
\item 6 Hashfunktionen auf den Inhalt des aktiven Fensters anzuwenden, \\
\item f"ur eine Datei den Hashwert zu berechnen, \\
\item in der Hash-Demo die Auswirkung von Text"anderungen auf den
      Hashwert zu testen,\\
\item aus einem Passwort gem"a"s dem PKCS\#5-Standard\index{PKCS\#5}
      einen Schl"ussel zu berechnen, \\
\item aus einem Text und einem geheimen Schl"ussel HMACs zu berechnen, und\\
\item aufgrund von gezielt gesuchten Hashwertkollisionen\index{Kollision}
      einen Angriff auf digitale Signaturen zu simulieren.
\end{list}
} an. Deren Output wird dann signiert.



%\newpage
\begin{center}
\fbox{\parbox{15cm}{{\em Stanislaw Lem\index{Lem, Stanislaw}\footnotemark:}\newline 
Wir k"onnen alles aus dieser Welt machen, nur nicht eine Welt, in der die
Menschen in einigen zigtausend Jahren "uberlegen k"onnten: 'So, es ist nun
genug. So soll es von nun an f"ur immer bleiben. Ver"andern wir nichts,
erfinden wir nichts, weil es besser nicht sein kann, und wenn doch, dann
wollen wir es nicht.'
}}
\end{center}
\addtocounter{footnote}{0}\footnotetext{Antwort von Stanislaw Lem auf
die Kritik an seinem philosophischen Hauptwerk ~\glqq Summa Technologiae'',
1964, in der er die evolution"are M"oglichkeit einer Entstehung der
k"unstlichen Intelligenz ausf"uhrte.\\}

% --------------------------------------------------------------------------
\vskip + 15pt
\hypertarget{Hash-functions-ht}{}
\subsection{Hashfunktionen}
\index{Hashfunktion}
Eine {\em Hashfunktion}\footnote{%
Hashverfahren berechnen eine komprimierte Repr"asentation 
elektronischer Daten (Message).
Die Verarbeitung dieser Message durch das Hashverfahren ergibt als Output
einen sogenannten Message Digest. Message Digests sind typischerweise
zwischen 128 und 512 Bit lang -- abh"angig vom Algorithmus. 
Sichere Hashverfahren werden typischerweise mit anderen kryptographischen
Algorithmen kombiniert, wie z.B. Digitale-Signatur-Algorithmen,
Keyed-Hash Message Authentication Codes, oder bei der Erzeugung von
Zufallszahlen (Bits) benutzt.
}
bildet eine Nachricht beliebiger L"ange auf eine Zeichenfolge mit
konstanter Gr"o"se, den \index{Hashwert}
Hashwert, ab. 



% --------------------------------------------------------------------------
\vskip + 15pt
\subsubsection{Anforderungen an Hashfunktionen}

Kryptographisch sichere Hashfunktionen erf"ullen folgende Anforderungen
(Reihenfolge so, dass die Anforderungen ansteigen):
\begin{itemize}
 \item Standhaftigkeit gegen 1st-Pre-Image-Attacks:
      \index{Pre-Image-Attack!1st}  \\
      Es sollte praktisch unm"oglich sein, zu einer gegebenen Zahl eine
      Nachricht zu finden, die genau diese Zahl als Hashwert hat. \\
      Gegeben (fix): Hashwert H', \\
      Gesucht: Nachricht m, so dass gilt: H(m) = H'.
 \item Standhaftigkeit gegen 2nd-Pre-Image-Attacks:
      \index{Pre-Image-Attack!2nd}  \\
      Es sollte praktisch unm"oglich sein, zu einer gegebenen Nachricht
      eine zweite Nachricht zu finden, die genau denselben Hashwert hat. \\
      Gegeben (fix): Nachricht m1 [und damit der Hashwert H1 = H(m1)], \\
      Gesucht: Nachricht m2, so dass gilt: H(m2) = H1.
 \item Standhaftigkeit gegen Kollisionsangriffe:
      \index{Angriff!Kollisionsangriff}  \\
      Es sollte es praktisch unm"oglich sein, zwei (beliebige) Nachrichten
      mit demselben Hashwert (welcher ist egal) zu finden. \\
      Gesucht: 2 Nachrichten m1 und m2, so dass gilt: H(m1) = H(m2).
\end{itemize}




% --------------------------------------------------------------------------
\vskip + 15pt
\subsubsection{Aktuelle Angriffe gegen Hashfunktionen wie SHA-1}
\label{collision-attacks-against-sha-1}

Bisher konnte die Existenz von perfekt sicheren kryptographischen
Hashfunktionen nicht formal bewiesen werden. 

"Uber mehrere Jahre gab es keine neuen Attacken gegen Hashverfahren,
und allgemein wurde den Kandidaten, die in der Praxis bislang keine
Schw"achen in ihrer Struktur gezeigt hatten 
(zum Beispiel \index{SHA-1} SHA-1\footnote{%
  SHA-1 \index{SHA-1} ist eine in den Standards FIPS 180-1 (durch die
  US-Beh"orde NIST), ANSI X9.30 Part 2 und
  \cite{FIPS186} spezifizierte 160-Bit Hashfunktion.\\
  SHA bedeutet ``Secure Hash Algorithm'' und wird h"aufig benutzt, z.B. 
  mit DSA, RSA oder ECDSA.\\
  Der aktuelle Standard \cite{FIPS180-2} definiert vier sichere Hashverfahren
  -- SHA-1, SHA-256, SHA-384 und SHA-512.
  F"ur diese Hashalgorithmen sind in der Testsuite FIPS 140-2 auch
  Validierungstests definiert.

  Die Ausgabel"ange der SHA-Algorithmen wurde vergr"o"sert aufgrund der
  M"oglichkeit von Geburtstagsangriffen:
  \index{Angriff!Geburtstagsangriff} \index{Kollision}
  diese machen -- grob gesprochen -- den n-Bit AES und ein 2n-bit 
  Hashverfahren "aquivalent: \\
  - 128-bit AES -- SHA-256 \\
  - 192-bit AES -- SHA-384 \\
  - 256-bit AES -- SHA-512.

  Mit CrypTool\index{CrypTool} k"onnen Sie den Geburtstagsangriff
  \index{Angriff!Geburtstagsangriff} auf digitale Signaturen 
  nachvollziehen: \\
  "uber das Men"u {\bf Analyse \textbackslash{} Hashverfahren
  \textbackslash{} Angriff auf den Hashwert der digitalen Signatur}.
  } 
oder \index{RIPEMD-160} RIPEMD-160\footnote{%
  RIPEMD-160, RIPEMD-128 und die optionale Erweiterung RIPEMD-256 haben
  Object Identifier, definiert von der ISO-identifizierten Organisation
  TeleTrusT, sowohl f"ur Hashverfahren als auch in Kombination mit RSA.
  RIPEMD-160 ist Teil des internationalen ISO/IEC-Standards 
  ISO/IEC 10118-3:1998 f"ur dedizierte Hashfunktionen, zusammen mit
  RIPEMD-128 and SHA-1. Weitere Details: \\
- \href{http://www.esat.kuleuven.ac.be/~bosselae/ripemd160.html}
   {\tt http://www.esat.kuleuven.ac.be/\~{}bosselae/ripemd160.html}\\
- \href{http://www.ietf.org/rfc/rfc2857.txt}
   {\tt http://www.ietf.org/rfc/rfc2857.txt} (``The Use of HMAC-RIPEMD-160-96
   within ESP and AH'').
  }%
) vertraut.

Auf der Crypto 2004 (August 2004)\footnote{%
    \href{http://www.iacr.org/conferences/crypto2004/}
 {\texttt{http://www.iacr.org/conferences/crypto2004/}} }
wurde dieses Sicherheitsgef"uhl jedoch stark in Zweifel gezogen: 
Chinesische Wissenschaftler ver"offentlichten
Kollisionsangriffe gegen MD4, SHA-0 und Teile von SHA-1, die
weltweit zu einer starken Besch"aftigung mit neuen Hash-Angriffen
f"uhrte.

Die Ver"offentlichung von Details zu den Resultaten der
chinesischen Kryptologen wurde bisher nur angek"undet: Nach ihren 
Angaben kann man
Kollisionen von SHA-1 mit einem Arbeitsaufwand von $2^{69}$ finden.
Damit w"are gezeigt, dass SHA-1 kryptographische Schw"achen besitzt, 
da die Konstruktion von SHA-1 an sich einen Mindestarbeitsaufwand 
f"ur die Kollisionssuche von etwa $2^{80}$ gew"ahrleisten sollte.
Der Wert $2^{69}$ ist dabei eine auf theoretischen Hochrechnungen 
beruhende Vorhersage. 
Die Sicherheit bereits erstellter Signaturen wird durch den geschilderten
Kollisionsangriff aber nicht gef"ahrdet. 

% be_2005_UPDATEN_if-hash-attacks-make-progress
Nach dem aktuellen Kenntnisstand ist keine Panik angesagt, aber f"ur
digitale Signaturen sollten zumindest in Zukunft l"angere Hashwerte und/oder
andere Verfahren benutzt werden.

Das NIST hat schon vor Bekanntwerden der neuen Ergebnisse angek"undigt,
SHA-1 in den n"achsten Jahren auslaufen zu lassen. Es ist daher zu
empfehlen, f"ur neue Produkte zur Erstellung von Sig"-naturen SHA-1 nicht
mehr zu verwenden.

Weitere Informationen zu diesem Thema finden sich z.B. in dem Artikel
\glqq Hash mich -- Konsequenzen der erfolgreichen Angriffe auf SHA-1\grqq\
von Reinhard Wobst und J"urgen Schmidt\footnote{% 
      \href{http://www.heise.de/security/artikel/56555}
   {\texttt{http://www.heise.de/security/artikel/56555}}. \\
  Weitere Quellen sind z.B.: \\
      \href{http://www.bsi.bund.de/esig/basics/techbas/krypto/index.htm}
   {\texttt{http://www.bsi.bund.de/esig/basics/techbas/krypto/index.htm}} \\
      \href{http://csrc.nist.gov/CryptoToolkit/tkhash.html}
   {\texttt{http://csrc.nist.gov/CryptoToolkit/tkhash.html}}.
} 
  von Heise Security.




% --------------------------------------------------------------------------
\vskip + 15pt
\subsubsection{Signieren mit Hilfe von Hashfunktionen}
Das Signatur-Verfahren mit Hashfunktion (ohne den oben genannten Nachteil)
sieht folgenderma"sen aus:\\ Anstatt das eigentliche Dokument zu signieren,
berechnet der Absender nun zuerst den Hashwert der Nachricht und signiert
diesen. Der Empf"anger bildet ebenfalls den Hashwert der Nachricht (der
benutzte Algorithmus muss bekannt sein). Er "uberpr"uft dann, ob die
mitgeschickte Signatur eine korrekte Signatur des Hashwertes ist. Ist dies der
Fall, so wurde die Signatur korrekt verifiziert. Die Authentizit"at der
Nachricht ist damit gegeben, da wir angenommen hatten, dass aus der Kenntnis
des "offentlichen Schl"ussels nicht der geheime Schl"ussel abgeleitet werden
kann. Dieser geheime Schl"ussel w"are jedoch notwendig, um Nachrichten in einem
fremden Namen zu signieren.

Einige digitale Signaturverfahren basieren auf asymmetrischer
Verschl"usselung, das bekannteste Beispiel dieser Gattung ist RSA. F"ur die
RSA-Signatur verwendet man die gleiche mathematische Operation wie zum
Entschl"usseln, nur wird sie auf den Hash-Wert des zu unterschreibenden
Dokuments angewendet.

Andere Systeme der digitalen Signatur wurden, wie DSA (Digital Signature
Algorithm), ausschlie"slich zu diesem Zweck entwickelt, und stehen in
keiner direkten Verbindung zu einem entsprechenden
Verschl"usselungsverfahren.

Beide Signaturverfahren, RSA und DSA, werden in den folgenden beiden
Abschnitten n"aher beleuchtet. Anschlie"send gehen wir einen Schritt weiter
und zeigen, wie basierend auf der elektronischen Unterschrift das digitale
Pendant zum Personalausweis entwickelt wurde. Dieses Verfahren nennt man
Public Key-Zertifizierung.


% --------------------------------------------------------------------------
\vskip + 15pt
\subsection{RSA-Signatur}
\index{Signatur!digitale}
\index{Signatur!RSA}
\index{RSA!Signatur}

\def\Mod#1{\ (\mbox{mod }#1)}

Wie im Kommentar am Ende von \hyperlink{RSAproof}{Abschnitt
\ref{RSAproof}} bemerkt, ist es m"oglich, die RSA-Operationen mit dem
privaten und "offentlichen Schl"ussel in umgekehrter Reihenfolge auszuf"uhren,
d.~h.\ $M$ hoch $d$ hoch $e \Mod{N}$ ergibt wieder $M$. Wegen dieser
simplen Tatsache ist es m"oglich, RSA als Signaturverfahren zu
verwenden. 

Eine RSA-Signatur $S$ zur die Nachricht $M$ wird durch folgende Operation
mit dem privaten Schl"ussel erzeugt:
$$ S \equiv M^d \Mod{N} $$
Zur Verifikation wird die korrespondierende Public Key-Operation auf der
Signatur $S$ ausgef"uhrt und das Ergebnis mit der Nachricht $M$ verglichen:
$$
S^e \equiv (M^d)^e \equiv (M^e)^d \equiv M \Mod{N}$$
Wenn das Ergebnis
$S^e$ mit der Nachricht $M$ "ubereinstimmt, dann akzeptiert der Pr"ufer die
Sig"-natur, andernfalls ist die Nachricht entweder ver"andert worden, oder
sie wurde nicht vom Inhaber von $d$ unterschrieben.

Wie weiter oben erkl"art, werden Signaturen in der Praxis nie direkt auf der
Nachricht ausf"uhrt, sondern auf einem kryptographischen Hashwert davon. Um
verschiedene Attacken auf das Sig"-naturverfahren (und seine Kombination mit
Verschl"usselung) auszuschlie"sen, ist es n"otig, den Hashwert vor der
Exponentiation auf spezielle Weise zu formatieren, wie in PKCS\#1 (Public
Key Cryptography Standard \#1 \cite{PKCS1})\index{PKCS\#1} beschrieben. 
Der Tatsache, dass
dieser Standard nach mehreren Jahren Einsatz revidiert werden musste, kann
als Beispiel daf"ur dienen, wie schwer es ist, kryptographische Details
richtig zu definieren.


% --------------------------------------------------------------------------
\vskip + 15pt
\subsection{DSA-Signatur}
\index{Signatur!digitale}
\index{Signatur!DSA}
\index{DSA-Signatur}

Im August 1991 hat das U.S. National Institute of Standards and Technology
(NIST)\index{NIST} einen digitalen Signaturalgorithmus (DSA, Digital Signature
Algorithm) vorgestellt, der sp"ater zum U.S. Federal Information Processing
Standard (FIPS 186 \cite{FIPS186}) wurde.

Der Algorithmus ist eine Variante des ElGamal-Verfahrens. Seine Sicherheit
beruht auf dem Diskreten Logarithmus
Problem\index{Logarithmusproblem!diskret}. Die Bestandteile des privaten
und "offentlichen DSA-Schl"ussels, sowie die Verfahren zur Signatur und
Verifikation sind im Folgenden zusammengefasst.


\paragraph{"Offentlicher Schl"ussel}\strut\\
\begin{tabular}{l@{ }l}
$p$ & prim \\
$q$ & 160-Bit Primfaktor von $p - 1$ \\
$g$ & $ = h^{(p-1)/q}  \mbox{ mod } p$, wobei $h < p - 1$ und
$h^{(p-1)/q} > 1  \Mod{p}$ \\
$y$ & $\strut \equiv  g^x  \mbox{ mod } p$ 
\end{tabular}

\emph{Bemerkung:} Die Parameter $p,q$ und $g$ k"onnen von einer Gruppe von
Benutzern gemeinsam genutzt werden.

\paragraph{Privater Schl"ussel}\strut\\
\begin{tabular}{l@{ }l}
$x < q$ (160-Bit Zahl) 
\end{tabular}

\paragraph{Signatur}\strut\\
\begin{tabular}{l@{ }l}
$m$ & zu signierende Nachricht\\
$k$ & zuf"allig\index{Zufall} gew"ahlte Primzahl, kleiner als $q$\\
$r$ & $= (g^k \; \mbox{ mod } p) \mbox{ mod } q$\\
$s$ & $= (k^{-1}(\mbox{SHA-1}(m) + xr)) \mbox{ mod } q$
\end{tabular}

\emph{Bemerkung:}
\begin{itemize}
\item $(s,r)$ ist die Signatur.
\item Die Sicherheit der Signatur h"angt nicht nur von der Mathematik ab,
sondern auch von der Verf"ugbarkeit einer guten Zufallsquelle\index{Zufall}
f"ur $k$.
\item SHA-1 \index{SHA-1} ist eine 160-Bit Hashfunktion.

\end{itemize}
\paragraph{Verifikation}\strut\\
\begin{tabular}{l@{ }l}
$w$ & $= s^{-1} \;  \mbox{ mod } q$\\
$u_1$ & $= (\mbox{SHA-1}(m)w) \mbox{ mod } q$\\
$u_2$ & $= (rw)  \mbox{ mod } q$\\
$v$ & $= (g^{u_1}y^{u_2}) \mbox{ mod } p)  \mbox{ mod } q$\\

\end{tabular}

\emph{Bemerkung:} Wenn $v = r$, dann ist die Signatur g"ultig.

Obwohl DSA unabh"angig von einem Verschl"usselungsverfahren so spezifiziert
wurde, dass es aus L"ander exportiert werden kann, die den Export von
kryptographischer Hard- und Software einschr"anken (wie die USA zum
Zeitpunkt der Spezifikation), wurde festgestellt
\cite[S.~490]{5Schneier1996ds}, dass die Operationen des DSA dazu geeignet
sind, nach RSA bzw. ElGamal zu verschl"usseln.



% --------------------------------------------------------------------------
\vskip + 15pt
\subsection{Public Key-Zertifizierung}
\index{Zertifizierung!Public Key}
\index{PKI}
Ziel der Public Key-Zertifizierung ist es, die Bindung eines 
"offentlichen Schl"ussels an einen Benutzers zu garantieren und nach au"sen
nachvollziehbar zu machen. In F"allen, in denen nicht sichergestellt werden
kann, dass ein "offentlicher Schl"ussel auch wirklich zu einer bestimmten
Person geh"ort, sind viele Protokolle nicht mehr sicher, selbst wenn die
einzelnen kryptographischen Bausteine nicht geknackt werden k"onnen.



% --------------------------------------------------------------------------
\vskip + 15pt
\subsubsection{Die Impersonalisierungsattacke} 
\index{Impersonalisierungsattacke} \label{Impersonalisierungsattacke}

Angenommen Charlie hat zwei Schl"usselpaare (PK1, SK1) und (PK2, SK2). 
Hierbei bezeichnet SK den geheimen Schl"ussel (secret key) und PK den
"offentlichen Schl"ussel (public key). Weiter angenommen, es gelingt ihm,
Alice PK1 als "offentlichen Schl"ussel von Bob und Bob PK2 als
"offentlichen Schl"ussel von Alice \glqq unterzujubeln\grqq (etwa indem
er ein "offentliches Schl"usselverzeichnis f"alscht).

Dann ist folgender Angriff m"oglich:
\begin{itemize}
    \item Alice m"ochte eine Nachricht an Bob senden. Sie verschl"usselt diese
          mit PK1, da sie denkt, dies sei Bobs "offentlicher Schl"ussel.
          Anschlie"send signiert sie die Nachricht mit ihrem geheimen
         Schl"ussel und schickt sie ab.
    \item Charlie f"angt die Nachricht ab, entfernt die Signatur und
          entschl"usselt die Nachricht mit SK1. Wenn er m"ochte, kann er die
          Nachricht anschlie"send nach Belieben ver"andern. Dann
          verschl"usselt er sie wieder, aber diesmal mit dem echten
          "offentlichen Schl"ussel von Bob, den er sich aus einem
          "offentlichen Schl"usselverzeichnis geholt hat, signiert sie mit
          SK2 und schickt die Nachricht weiter an Bob.
    \item Bob "uberpr"uft die Signatur mit PK2 und wird zu dem Ergebnis
          kommen, dass die Signatur in Ordnung ist. Dann entschl"usselt er
          die Nachricht mit seinem geheimen Schl"ussel.
\end{itemize}

Charlie ist so in der Lage, die Kommunikation zwischen Alice und Bob
abzuh"oren und die ausgetauschten Nachrichten zu ver"andern, ohne dass dies
von den beteiligten Personen bemerkt wird. Der Angriff funktioniert
auch, wenn Charlie nur ein Schl"usselpaar hat.

Ein anderer Name f"ur diese Art von Angriffen ist 
\index{Angriff!Man-in-the-middle-attack}
\glqq man-in-the-middle-attack\grqq. Hilfe gegen diese Art von Angriffen
verspricht die Public Key-Zertifizierung, die die \index{Authentizit""at}
Authentizit"at "offentlicher Schl"ussel garantieren kann. Die am weitesten
verbreitete Zertifizierungsmethode ist der X.509-Standard.

% --------------------------------------------------------------------------
\vskip + 15pt
\subsubsection{X.509-Zertifikat}
\index{X.509}
Jeder Teilnehmer, der sich per X.509-Zertifikat \cite{X.509}
die Zugeh"origkeit seines "offentlichen Schl"ussels zu seiner realen Person
best"atigen lassen m"ochte, wendet sich an eine sogenannte
\index{Certification Authority (CA)} Certification Authority (CA)\footnote{%
Oft auch Trustcenter oder im deutschen Signaturgesetz
\glqq Zertifizierungsdiensteanbieter\grqq\ genannt, wenn die Zertifikate nicht
nur einer geschlossenen Benutzergruppe angeboten werden.
}.
Dieser beweist er seine Identit"at (etwa durch Vorlage seines 
Personalausweises). Anschlie"send stellt die CA ihm ein elektronisches
Dokument (Zertifikat) aus, in dem im wesentlichen der Name des 
Zertifikatnehmers und der Name der CA, der "offentliche Schl"ussel des 
Zertifikatnehmers und der G"ultigkeitszeitraum des Zertifikats vermerkt
sind. Die CA unterzeichnet das Zertifikat anschlie"send mit ihrem geheimen
Schl"ussel.
  
Jeder kann nun anhand des "offentlichen Schl"ussels der CA "uberpr"ufen, ob
das Zertifikat unverf"alscht ist. Die CA garantiert also die Zugeh"origkeit
von Benutzer und "offentlichem Schl"ussel.

Dieses Verfahren ist nur so lange sicher, wie die Richtigkeit des
"offentlichen Schl"ussels der CA sichergestellt ist. Aus diesem Grund l"asst
jede CA ihren "offentlichen Schl"ussel bei einer anderen CA zertifizieren,
die in der Hierarchie "uber ihr steht. In der obersten Hierarchieebene
(Wurzelinstanz) gibt es in der Regel nur eine CA, die dann nat"urlich keine
M"oglichkeit mehr hat, sich ihren Schl"ussel bei einer anderen CA
zertifizieren zu lassen. Sie ist also darauf angewiesen, ihren Schl"ussel
auf andere Art und Weise gesichert zu "ubermitteln. Bei vielen
Software-Produkten, die mit Zertifikaten arbeiten (zum Beispiel den
Webbrowsern von Microsoft und Netscape) sind die Zertifikate dieser
Wurzel-CAs schon von Anfang an fest in das Programm eingebettet und k"onnen
auch vom Benutzer nachtr"aglich nicht mehr ge"andert werden. Aber auch durch
"offentliche Bekanntgabe in Zeitungen k"onnen ("offentliche) CA-Schl"ussel
gesichert "ubermittelt werden.


\newpage
\begin{thebibliography}{99999}
\addcontentsline{toc}{subsection}{Literaturverzeichnis}

\bibitem[FIPS180-2]{FIPS180-2} U.S. Department of Commerce/N.I.S.T. ,
    \index{FIPS180-2} \\
    {\em Secure Hash Standard (SHS)}, \\
    August 1, 2002.\\
    (FIPS 180-2 will supersede FIPS 180-1 beginning February 1, 2003.)

\bibitem[FIPS186]{FIPS186} U.S. Department of Commerce/N.I.S.T. ,
    \index{FIPS186} \\
    {\em Entity authentication using public key cryptography}, \\
    Februar 18, 1997.\\
    Nicht mehr g"ultig.

\bibitem[FIPS186-2]{FIPS186-2} U.S. Department of Commerce/N.I.S.T. ,
    \index{FIPS186-2} \\
    {\em Digital Signature Standard (DSS)}, \\
    Januar 27, 2000. Change Note: Oktober 5, 2001.\\
  \href{http://csrc.nist.gov/publications/fips/fips186-2/fips186-2-change1.pdf}
   {\tt http://csrc.nist.gov/publications/fips/fips186-2/fips186-2-change1.pdf}

\bibitem[PKCS1]{PKCS1} RSA Laboratories,  
    \index{PKCS\#1} \index{RSA Laboratories} \\
    {\em PKCS \#1 v2.1 Draft 3: RSA Cryptography Standard}, \\
    April 19, 2002.

\bibitem[Schneier1996]{5Schneier1996ds} \index{Schneier 1996} 
    Bruce Schneier, \\
    {\em Applied Cryptography, Protocols, Algorithms, and Source Code in C}, \\
    Wiley, 2nd edition, 1996.

\bibitem[Wobst2005]{Wobst2005} \index{Wobst 2005} 
    Reinhard Wobst, \\
    {\em New Attacks Against Hash Functions}, \\
    Information Security Bulletin, April 2005.

\bibitem[X.509]{X.509} ITU-T,
    \index{X.509} \\
    {\em ITU-T Recommendation X.509 (1997 E): Information Technology -- 
    Open Systems Interconnection -- The Directory: Authentication Framework},\\
    Juni 1997.

\bibitem[X.509v3]{X.509v3} ITU-T, 
    \index{X.509} \index{ITU-T} \index{ISO/IEC 9594-8} \\
    {\em X.509 (1993) Amendment 1: Certificate Extensions, The Directory
    Authentication Framework},\\ 
    International Telecommunication Union, Geneva, Switzerland, July 1995\\
    (equivalent to amendment 1 to ISO/IEC 9594-8).

\end{thebibliography}
                                                          


% Local Variables:
% TeX-master: "../script-de.tex"
% End:
