<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<TITLE>SHA-1-Hashwert</TITLE>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<link rel="stylesheet" type="text/css" href="CrypTool_Help.css">
</HEAD>

<!-- multiple keywords for CrypTool HTML help index -->
<OBJECT type="application/x-oleobject" classid="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e">
	<PARAM NAME="Keyword" VALUE="Hashfunktion">
	<PARAM NAME="Keyword" VALUE="SHA-1-Hashwert">
</OBJECT>

<BODY>

<h3>SHA-1 (Menü <A href="menu_related_methods.html">Einzelverfahren</A> \ Hashverfahren)</h3>

		<P>Der SHA-1-Algorithmus (Secure Hash Algorithm) liefert einen <!--ZZZPOPUP--><A href="hashwert.html">Hashwert</A>
			der Länge 160 Bits (= 20 Bytes). Es ist der Nachfolger des <a href="hid_crypt_hash_sha.html">SHA</a>-Verfahrens.
		</P>
		<P>Neben RIPEMD-160 ist dieses 1991 von der <!--ZZZPOPUP--><A href="nist.html">NIST</A>
			veröffentlichte Hashverfahren die derzeit wichtigste kryptographische 
			Hashfunktion.</P>
		<P>Der Algorithmus ist im FIPS180-1 beschrieben, hier ein Auszug:</P>
		<B>1. MESSAGE PADDING</B>
		<P>The SHA-1 is used to compute a message digest for a message or data file that is 
			provided as input. The message or data file should be considered to be a bit 
			string. The length of the message is the number of bits in the message (the 
			empty message has length 0). If the number of bits in a message is a multiple 
			of 8, for compactness we can represent the message in hex. The purpose of 
			message padding is to make the total length of a padded message a multiple of 
			512. The SHA-1 sequentially processes blocks of 512 bits when computing the 
			message digest. The following specifies how this padding shall be performed. As 
			a summary, a "1" followed by m "0"s followed by a 64-bit integer are appended 
			to the end of the message to produce a padded message of length 512 * n. The 
			64-bit integer is l, the length of the original message. The padded message is 
			then processed by the SHA-1 as n 512-bit blocks.
		</P>
		<P>The padded message will contain 16 * n words for some n &gt; 0. The padded 
			message is regarded as a sequence of n blocks M<SUB>1</SUB> , M<SUB>2</SUB>, 
			... , M<SUB>n</SUB>, where each M<SUB>i</SUB> contains 16 words and M<SUB>1</SUB>
			contains the first characters (or bits) of the message.</P>
		<B>2. FUNCTIONS USED</B>
		<P>A sequence of logical functions f<SUB>0</SUB>, f<SUB>1</SUB>,..., f<SUB>79</SUB> 
			is used in the SHA-1. Each f<SUB>t</SUB>, 0 &lt;= t &lt;= 79, operates on three 
			32-bit words B, C, D and produces a 32-bit word as output. f<SUB>t</SUB>(B,C,D) 
			is defined as follows: for words B, C, D.</P>
		<P>f<SUB>t</SUB>(B,C,D) = (B AND C) OR ((NOT B) AND D) ( 0 &lt;= t &lt;= 19)
		</P>
		<P>f<SUB>t</SUB>(B,C,D) = B XOR C XOR D (20 &lt;= t &lt;= 39)
		</P>
		<P>f<SUB>t</SUB>(B,C,D) = (B AND C) OR (B AND D) OR (C AND D) (40 &lt;= t &lt;= 59)
		</P>
		<P>f<SUB>t</SUB>(B,C,D) = B XOR C XOR D (60 &lt;= t &lt;= 79).</P>
		<B>3. CONSTANTS USED</B>
		<P>A sequence of constant words K(0), K(1), ... , K(79) is used in the SHA-1. In 
			hex these are given by
		</P>
		<P>K = 5A827999 ( 0 &lt;= t &lt;= 19)
		</P>
		<P>K<SUB>t</SUB> = 6ED9EBA1 (20 &lt;= t &lt;= 39)
		</P>
		<P>K<SUB>t</SUB> = 8F1BBCDC (40 &lt;= t &lt;= 59)
		</P>
		<P>K<SUB>t</SUB> = CA62C1D6 (60 &lt;= t &lt;= 79).
		</P>
		<B>4. COMPUTING THE MESSAGE DIGEST</B>
		<P>The message digest is computed using the final padded message. The computation 
			uses two buffers, each consisting of five 32-bit words, and a sequence of 
			eighty 32-bit words. The words of the first 5-word buffer are labeled 
			A,B,C,D,E. The words of the second 5-word buffer are labeled H<SUB>0</SUB>, H<SUB>1</SUB>, 
			H<SUB>2</SUB>, H<SUB>3</SUB>, H<SUB>4</SUB>. The words of the 80-word sequence 
			are labeled W<SUB>0</SUB>, W<SUB>1</SUB>,..., W<SUB>79</SUB>. A single word 
			buffer TEMP is also employed.
		</P>
		<P>To generate the message digest, the 16-word blocks M<SUB>1</SUB>, M<SUB>2</SUB>,..., 
			M<SUB>n</SUB> defined in Section 4 are processed in order. The processing of 
			each M<SUB>i</SUB> involves 80 steps.
		</P>
		<P>Before processing any blocks, the {H<SUB>i</SUB>} are initialized as follows: in 
			hex,
		</P>
		<P>H<SUB>0</SUB> = 67452301
		</P>
		<P>H<SUB>1</SUB> = EFCDAB89
		</P>
		<P>H<SUB>2</SUB> = 98BADCFE
		</P>
		<P>H<SUB>3</SUB> = 10325476
		</P>
		<P>H<SUB>4</SUB> = C3D2E1F0.
		</P>
		<P>Now M<SUB>1</SUB>, M<SUB>2</SUB>, ... , M<SUB>n</SUB> are processed. To process 
			M<SUB>i</SUB>, we proceed as follows:
		</P>
		<OL type="a">
			<LI>
				Divide M<SUB>i</SUB> into 16 words W<SUB>0</SUB>, W<SUB>1</SUB>, ... , W<SUB>15</SUB>, 
				where W<SUB>0</SUB> is the left-most word.
				<BR>
				<BR>
			<LI>
				For t = 16 to 79 let W<SUB>t</SUB> = S<SUP>1</SUP>(W<SUB>t-3</SUB> XOR W<SUB>t-8</SUB>
				XOR W<SUB>t- 14</SUB> XOR W<SUB>t-16</SUB>).<BR>
				<BR>
			<LI>
				Let A = H<SUB>0</SUB>, B = H<SUB>1</SUB>, C = H<SUB>2</SUB>, D = H<SUB>3</SUB>, 
				E = H<SUB>4</SUB>.<BR>
				<BR>
			<LI>
				For t = 0 to 79 do
				<P>TEMP = S<SUP>5</SUP>(A) + f<SUB>t</SUB>(B,C,D) + E + W<SUB>t</SUB> + K<SUB>t</SUB>;
				</P>
				<P>E = D; D = C; C = S<SUP>30</SUP>(B); B = A; A = TEMP;
				</P>
				<BR>
				<BR>
			<LI>
				Let H<SUB>0</SUB> = H<SUB>0</SUB> + A, H<SUB>1</SUB> = H<SUB>1</SUB> + B, H<SUB>2</SUB>
				= H<SUB>2</SUB> + C, H<SUB>3</SUB> = H<SUB>3</SUB> + D, H<SUB>4</SUB> = H<SUB>4</SUB>
				+ E.
			</LI>
		</OL>
		<P>After processing M<SUB>n</SUB>, the message digest is the 160-bit string 
			represented by the 5 words
		</P>
		<P>H<SUB>0</SUB> H<SUB>1</SUB> H<SUB>2</SUB> H<SUB>3</SUB> H<SUB>4</SUB>.</P>
	</BODY>
</HTML>
