<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Example illustrating the Playfair encryption algorithm</TITLE>
<link rel="stylesheet" type="text/css" href="CrypTool_Help.css">
</HEAD>

<!-- multiple keywords for CrypTool HTML help index -->
<OBJECT TYPE="application/x-oleobject" CLASSID="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e" VIEWASTEXT ID="Object1">
	<PARAM NAME="Keyword" VALUE="Playfair encryption algorithm">
	<PARAM NAME="Keyword" VALUE="Encryption">
	<PARAM NAME="Keyword" VALUE="Examples / Scenarios">	
	<PARAM NAME="Keyword" VALUE="Scenarios / Demonstrations">
</OBJECT>

<BODY>

<h3>Example illustrating the Playfair encryption algorithm</h3>

<P>This section provides an <A href="hid_hilfe_szenarien.html">example</A> illustrating the use of the <A href="hid_playfair_bin.html">Playfair encryption algorithm</A>. To make it easier to follow the steps that need to be performed with <!--ZZZPOPUP--><A href="cryptool.html">CrypTool</A>, the example is illustrated with a number of screenshots.</P>

<P>We start with investigating the <A href="hid_playfair_bin.html">Playfair encryption algorithm</A> by opening a <!--ZZZPOPUP--><A href="dokument.html">document,</A> encrypting it and decrypting it again. After that we will try to find the key that was used to encrypt the plaintext by using the manual Playfair analysis step by step.</P>

<P><B>1. Playfair Encryption</B></P>

<P>1.1 Open the document to be encrypted: e.g. <CODE>CrypTool-en.txt</CODE>, which is part of the online 
help section. You can open that document via the menu <A href="menu_file.html">File</A> \ 
<A href="hid_file_open.html">Open</A>.</p>

<P><IMG SRC="images/playfairplaintext.gif" ALT="playfairplaintext.gif" BORDER=0></P>

<P>1.2 Now we <!--ZZZPOPUP--><A href="verschluesselung.html">encrypt</A> this document using the 
<A href="hid_playfair_bin.html">Playfair encryption algorithm</A>.</P>

<P>From the menu, choose <A href="menu_crypt.html">Encrypt/Decrypt</A> \
<A href="menu_crypt_symmetricclassic.html">Symmetric (classic)</A> \
<A href="hid_playfair_bin.html">Playfair</A>. The following dialog box is displayed:</P>

<P><IMG SRC="images/playfairkeydialog.png" ALT="playfairkeydialog.png" BORDER=0></P>

<P>Using the standard 5x5 key matrix, the <B>Playfair alphabet</B> consists of the normal capital 
letters A to Z, where J is taken out.</P>

<P>1.3 Please use PEGASOS as the key.</P>

<P>From this key the following Playfair key matrix will be calculated:</P>

<div style="text-align:center">

<TABLE cols=5 width="0*" class="pad10">

<TR VALIGN="top">
<TD>P</TD>
<TD>E</TD>
<TD>G</TD>
<TD>A</TD>
<TD>S</TD>
</TR>

<TR VALIGN="top">
<TD>O</TD>
<TD>B</TD>
<TD>C</TD>
<TD>D</TD>
<TD>F</TD>
</TR>

<TR VALIGN="top">
<TD>H</TD>
<TD>I</TD>
<TD>K</TD>
<TD>L</TD>
<TD>M</TD>
</TR>

<TR VALIGN="top">
<TD>N</TD>
<TD>Q</TD>
<TD>R</TD>
<TD>T</TD>
<TD>U</TD>
</TR>

<TR VALIGN="top">
<TD>V</TD>
<TD>W</TD>
<TD>X</TD>
<TD>Y</TD>
<TD>Z</TD>
</TR>
</TABLE><BR>

</div>

<P>1.4 When you push the button <B>Encrypt</B> the Playfair key entry dialog will be closed and two 
windows are opened: one with the pre-processed plaintext and another with the encrypted text:</P>

<P><IMG SRC="images/playfairpreformatandencryption.gif" ALT="playfairpreformatandencryption.gif" BORDER=0 width="91%"></P>

<UL>
	<LI>The pre-processing step removes all characters from the cleartext that are not part of the 
	<B>Playfair alphabet</B> and inserts the character X between two equal characters in a row. E.g. the 
	cleartext <B><CODE>CrypTool ist</CODE></B> (German for CrypTool is …) will be pre-processed to 
	<B><CODE>CRYPTOXOLIST</CODE></B>:</LI>

	<LI>Based on the Playfair key matrix above, the pre-processed text can now be encrypted. The basic 
	idea is that two consecutive characters (a di-gram) determine the two opposite edges of a rectangle in 
	the key matrix.<br>We consider <I>one dimensional</I> rectangles for the special case, when both 
	characters are in the same row or column of the key matrix.</LI>
</UL>

<P>1.5 Now, let us manually encrypt the pre-processed plaintext <B><CODE>CRYPTOXOLIST</CODE></B>. The 
following key matrix rectangles have to be considered:</P>

<div style="TEXT-ALIGN:left">
			<table border="0" ID="Table1">
				<tr>
					<td width="217">
						<TABLE cols="5" width="0*" class="pad10" ID="Table2">
							<TR VALIGN="top">
								<TD><FONT color="#3366ff"><STRONG>P</STRONG></FONT></TD>
								<TD>E</TD>
								<TD>G</TD>
								<TD><FONT color="#3366ff"><STRONG>A</STRONG></FONT></TD>
								<TD>S</TD>
							</TR>
							<TR VALIGN="top">
								<TD><FONT color="#00cc00"><STRONG>O</STRONG></FONT></TD>
								<TD>B</TD>
								<TD><FONT color="#ff0033"><STRONG>C</STRONG></FONT></TD>
								<TD><FONT color="#00cc00"><STRONG>D</STRONG></FONT></TD>
								<TD>F</TD>
							</TR>
							<TR VALIGN="top">
								<TD height="20">H</TD>
								<TD height="20">I</TD>
								<TD height="20"><FONT color="#ff0033"><STRONG>K</STRONG></FONT></TD>
								<TD height="20">L</TD>
								<TD height="20">M</TD>
							</TR>
							<TR VALIGN="top">
								<TD><FONT color="#00cc00"><STRONG>N</STRONG></FONT></TD>
								<TD>Q</TD>
								<TD><FONT color="#ff0033"><STRONG>R</STRONG></FONT></TD>
								<TD><FONT color="#00cc00"><STRONG>T</STRONG></FONT></TD>
								<TD>U</TD>
							</TR>
							<TR VALIGN="top">
								<TD><FONT color="#3366ff"><STRONG>V</STRONG></FONT></TD>
								<TD>W</TD>
								<TD><FONT color="#ff0033"><STRONG>X</STRONG></FONT></TD>
								<TD><FONT color="#3366ff"><STRONG>Y</STRONG></FONT></TD>
								<TD>Z</TD>
							</TR>
						</TABLE>
					</td>
					<td align="center">&nbsp;&lt; -- &gt;
					</td>
					<td>
						<TABLE class="pad10" id="Table3" cols="4" width="0*">
							<TR vAlign="top">
								<TD>Plaintext di-gram</TD>
								<TD>Rectangle</TD>
								<TD>Dimension</TD>
								<TD>Encryption</TD>
							</TR>
							<TR vAlign="top">
								<TD>CR</TD>
								<TD><FONT color="#ff0033"><STRONG>C,K,R,X</STRONG></FONT></TD>
								<TD>1</TD>
								<TD>KX</TD>
							</TR>
							<TR vAlign="top">
								<TD>YP</TD>
								<TD><FONT color="#3366ff"><STRONG>Y,V,P,A</STRONG></FONT></TD>
								<TD>2</TD>
								<TD>VA</TD>
							</TR>
							<TR vAlign="top">
								<TD>TO</TD>
								<TD><FONT color="#00cc00"><STRONG>T,N,O,D</STRONG></FONT></TD>
								<TD>2</TD>
								<TD>ND</TD>
							</TR>
							<TR vAlign="top">
								<TD height="10">XO</TD>
								<TD height="10">X,V,O,C</TD>
								<TD height="10">2</TD>
								<TD height="10">VC</TD>
							</TR>
							<TR vAlign="top">
								<TD>LI</TD>
								<TD>L,M,I,K</TD>
								<TD>1</TD>
								<TD>MK</TD>
							</TR>
							<TR vAlign="top">
								<TD>ST</TD>
								<TD>S,A,T,U</TD>
								<TD>2</TD>
								<TD>AU</TD>
							</TR>
						</TABLE>
					</td>
				</tr>
			</table>
			<BR>
		</div>

<P>For two dimensional rectangles we enumerate the edges as follows: we start with the first plaintext 
character, then choose the character in the other edge <I>on the same row</I>, then the second cleartext 
character. The last character is taken from the remaining edge.</P>

<P>In the less common case of one dimensional rectangles we also start with the first plaintext 
character, followed by the bottom resp. right neighbor, the second cleartext character and then its 
bottom resp. right neighbor.</P>

<P>The second and fourth character of the rectangle (the unused edges) are taken to be the encrypted 
di-gram, in the example above: <CODE>KXVANDVCMKAU</CODE>.</P>

<P>1.6 To proceed with the next step (decryption) you can avoid entering the key again by recovering it 
from the ciphertext window. To do this </P>

<UL>
	<LI>activate the window with the ciphertext</LI>

	<LI>click on the icon <IMG SRC="images/iconkeydialog.gif" ALT="iconkeydialog.gif" BORDER=0>  or select menu Edit \ Show Key</LI>

	<LI>press <B>Copy key</B> </LI>
</UL>

<P>Now the key matrix is stored in CrypTool's key store.</P>

<P><B>2. Playfair Decryption</B></P>

<P>We now can recover the plaintext of the document encrypted in the previous step.</P>

<P>2.1 Select the menu <A href="menu_crypt.html">Encrypt/Decrypt</A> \ 
<A href="menu_crypt_symmetricclassic.html">Symmetric (classic)</A> \
<A href="hid_playfair_bin.html">Playfair</A>.</P>

<P>2.2 Enter the encryption key (PEGASOS). If you have saved the key in the
<a href="keystore.html">internal key storage</a> then you can recover 
it by clicking on the icon <IMG SRC="images/iconinsertkey.gif" ALT="iconinsertkey.gif" BORDER=0>.</P>

<P><IMG SRC="images/dialogplayfairdecryption.gif" ALT="dialogplayfairdecryption.gif" BORDER=0></P>

<P>2.3 Press the <B>Decrypt</B> button to recover the plaintext.</P>

<P><B>3. Manual analysis of the Playfair cipher</B></P>

<P>Let us now try to decipher a text encrypted with the Playfair cipher where we don't know the key 
(ciphertext-only analysis).</P>

<P>3.1 To do this we load the text to be decrypted from the file <CODE>Playfair-enc-de.txt</CODE> (this 
file can be found in the <CODE>examples</CODE> directory distributed with CrypTool):</P>

<P><IMG SRC="images/szenarioplayfair1.gif" ALT="szenarioplayfair1.gif" BORDER=0></P>

<P>3.2 This text was created with the <A href="hid_playfair_bin.html">Playfair</A> 
<!--ZZZPOPUP--><A href="verschluesselung.html">encryption algorithm</A> <I>without</I> pre-processing: 
This option effectively leaves characters not contained in the Playfair alphabet unencrypted (e.g. blanks, 
punctuation marks, line feeds), so that the plaintext word and sentence boundaries are obvious.</P> 

<P>Additionally, the insertion of the separating X between two equal, consecutive characters is switched 
off so double characters are left unencrypted.</P>

<P>3.3 CrypTool does only support a semi-manual analysis of the Playfair cipher. Therefore we need some 
clue about the document to be analyzed. Let us assume that the text is a German letter, which often start 
with the same words.</P>

<P>3.4 Let us now open the Playfair analysis dialog window by selecting the menu 
<A href="menu_analyze.html">Analysis</A> \ Symmetric Encryption (classic) \ Manual Analysis \ Playfair.</P>

<P>Here you see the text of the opened ciphertext file in the first row of the field "Analysis result".</P>

<P><IMG SRC="images/szenarioplayfair2.gif" ALT="szenarioplayfair2.gif" BORDER=0></P>

<P>3.5 We assume: The letter probably begins with <B><CODE>Sehr geehrte Damen und Herren</CODE></B> 
(German for <I>Dear Sirs</I>).</P>

<P>Enter this text in the field labeled <B>Expected plaintext.</B> After each key stroke the <B>Letter information </B>table is updated.</P>

<P>We now already have a couple of di-grams fixed: </P>

<div class="indent">

<TABLE cols=2 width="0*" class="pad20" style="text-align:center">

<TR VALIGN="top">
<TD>SE  &gt;  TG
<P>HR  &gt;  IG</P>

<P>GE  &gt;  HR</P>

<P>EH  &gt;  RI</P>

<P>RT  &gt;  EF</P>

<P>ED  &gt;  RX</P>
</TD>
<TD>AM  &gt;  VN
<P>EN  &gt;  IX</P>

<P>UN  &gt;  AX</P>

<P>DH  &gt;  LR</P>

<P>ER  &gt;  RG</P>

<P>RE  &gt;  GR</P>
</TD>
</TR>
</TABLE><BR>

</div>

<P>3.6 By pressing the <B>Generate matrix</B> button, those parts of the Playfair key matrix are 
calculated, that can be determined based on the given information.</P>

<P><IMG SRC="images/szenarioplayfair3.gif" ALT="szenarioplayfair3.gif" BORDER=0></P>

<P>How to manually execute the calculation is shown <a href="#manualcalculationplayfair">here</a>.</P>

<P>3.7 Press the button <B>Synchronise analysis result \ Expected plaintext</B>.</p>

<P>The selected checkbox-option <B>Update expected plaintext</B> causes that the result of 
the decryption of the ciphertext based on the partial matrix is copied into the field 
"Expected plaintext". Characters that cannot (yet) be decrypted are marked with the wildcard 
character '<B><CODE>*</CODE></B>‘ and can now be replaced by guessing.</P>

<P>3.8 Now the character sequence <B><CODE>E**.*IEMLI**</CODE></B> catches our eye (at least the eye of 
people knowing some German). If we complete this with the field "Expected plaintext" to read 
<B><CODE>EIN.ZIEMLICH</CODE></B> two more di-gram mappings result: IN  &gt;  BO and CH  &gt;  HK. Based on 
the previous matrix and the first di-gram mapping we conclude, that the characters I,N,B,O have to be in 
the same column, i.e. B must be directly below I and O directly below N. Clicking on 
<B>Generate matrix</B> swaps row two and four, then row two and three etc. resulting in the following key 
matrix:</P>

<div style="text-align:center">

<TABLE cols=5 width="0*" class="pad10">

<TR VALIGN="top">
<TD>*</TD>
<TD>*</TD>
<TD>*</TD>
<TD>K</TD>
<TD>B</TD>
</TR>

<TR VALIGN="top">
<TD>U</TD>
<TD>Z</TD>
<TD>*</TD>
<TD>*</TD>
<TD>A</TD>
</TR>

<TR VALIGN="top">
<TD>X</TD>
<TD>D</TD>
<TD>M</TD>
<TD>L</TD>
<TD>N</TD>
</TR>

<TR VALIGN="top">
<TD>T</TD>
<TD>F</TD>
<TD>S</TD>
<TD>C</TD>
<TD>O</TD>
</TR>

<TR VALIGN="top">
<TD>E</TD>
<TD>R</TD>
<TD>G</TD>
<TD>H</TD>
<TD>I</TD>
</TR>
</TABLE><BR>

</div>

<P>3.9 Unfortunately, decrypting based on this matrix results in words that do not exist in the German language: </P>

<div class="indent">

<P><B><CODE>SEHR.GEEHRTE.DAMEN.UND.HERREN...EIN.ZIEMLICH.<BR>
GEHEIMER.*X**.BLEIOT.NICH*.IMMER.**NGE.GEHEIM..<BR>
MI*.*DXUNDLICHEN.GRUX**EN</CODE></B></P>

</div>

<P>However, we can now guess the cleartext with high probability, except for the word <B><CODE>*X**</CODE></B>, which we correct to read <B><CODE>****</CODE></B> (this is to avoid conflicts). We now correct the remaining words to read:</P>

<div class="indent">

<P><CODE>SEHR.GEEHRTE.DAMEN.UND.HERREN...EIN.ZIEMLICH.<BR>
GEHEIMER.*<B>*</B>**.BLEI<B>B</B>T.NICH<B>T</B>.IMMER.<B>LA</B>NGE.GEHEIM..<BR>
MI<B>T</B>.<B>FRE</B>UNDLICHEN.GRU<B>ESS</B>EN</CODE></P>

</div>

<P>3.10 This results in more di-gram mappings BT  &gt;  TF, TI  &gt;  BE, LA  &gt; NW, TF  &gt;  BZ, RE  &gt;  FT, SS  &gt;  KK and UE  &gt;  XT. One more click on <B>Generate matrix</B> yields:</P>

<div class="indent">

<P><CODE>SEHR.GEEHRTE.DAMEN.UND.HERREN...EIN.ZIEMLICH.<BR>
GEHEIMER.<B>TE</B>**.BLEIBT.NICHT.IMMER.LANGE.GEHEIM..<BR>
MIT.FREUNDLICHEN.GRUESSEN</CODE></P>

</div>

<div style="text-align:center">

<TABLE cols=5 width="0*" class="pad10">

<TR VALIGN="top">
<TD>T</TD>
<TD>F</TD>
<TD>S</TD>
<TD>K</TD>
<TD>B</TD>
</TR>

<TR VALIGN="top">
<TD>U</TD>
<TD>Z</TD>
<TD>V</TD>
<TD>W</TD>
<TD>A</TD>
</TR>

<TR VALIGN="top">
<TD>X</TD>
<TD>D</TD>
<TD>M</TD>
<TD>L</TD>
<TD>N</TD>
</TR>

<TR VALIGN="top">
<TD>*</TD>
<TD>*</TD>
<TD>*</TD>
<TD>C</TD>
<TD>O</TD>
</TR>

<TR VALIGN="top">
<TD>E</TD>
<TD>R</TD>
<TD>G</TD>
<TD>H</TD>
<TD>I</TD>
</TR>
</TABLE><BR>

</div>

</div>

<P>3.11 In a final step we correct <B><CODE>TE**</CODE></B> to read <B><CODE>TEXT</CODE></B> giving the 
di-gram mapping XT &gt; PU. The Playfair analysis now gives us the key matrix</P>

<div style="text-align:center">

<TABLE cols=5 width="0*" class="pad10">

<TR VALIGN="top">
<TD>T</TD>
<TD>F</TD>
<TD>S</TD>
<TD>K</TD>
<TD>B</TD>
</TR>

<TR VALIGN="top">
<TD>U</TD>
<TD>Z</TD>
<TD>V</TD>
<TD>W</TD>
<TD>A</TD>
</TR>

<TR VALIGN="top">
<TD>X</TD>
<TD>D</TD>
<TD>M</TD>
<TD>L</TD>
<TD>N</TD>
</TR>

<TR VALIGN="top">
<TD>P</TD>
<TD>*</TD>
<TD>*</TD>
<TD>C</TD>
<TD>O</TD>
</TR>

<TR VALIGN="top">
<TD>E</TD>
<TD>R</TD>
<TD>G</TD>
<TD>H</TD>
<TD>I</TD>
</TR>
</TABLE><BR>

</div>

<P>3.12 The cleartext originally had been encrypted with the password <B><CODE>HIERGIBTESWASZUENTDECKEN</CODE></B> 
(<a href="#Hinweis">see advice regarding the key matrix</a>), and the options <B>Preformat text</B> and <B>Ignore 
duplicates within the key phrase</B> were deactivated. We finally get the complete plaintext:</P>

<div class="indent">
<PRE><CODE>    SEHR.GEEHRTE.DAMEN.UND.HERREN...EIN.ZIEMLICH.
    GEHEIMER.TEXT.BLEIBT.NICHT.IMMER.LANGE.GEHEIM..</CODE>
    <CODE>MIT.FREUNDLICHEN.GRUESSEN</CODE></PRE>
</div>

<P>3.13 After clicking the button <B>Output results of analysis</B>, the Playfair analysis dialog window 
is closed and the cleartext is displayed.</P>

<p><B>Remark</B>:</p>
<a name="Hinweis">Advice regarding the key matrix:</a>

<p>A cyclicly shifted key matrix leads to the same result. Thus, the originally chosen 
password cannot be concluded from the calculated matrix.</p>

<br><br>
<P><B><a name="manualcalculationplayfair"></a>4. Manual calculation of the key matrix</B></P>

<P>We now show how the complete key matrix can be determined manually based on guessed cleartext fragments and the Playfair encryption rules.</P>

<UL>
	<LI>From ER &gt; RG one can see that the sequence ERG must occur in the matrix either within 
	one column or one row.<br>Let us assume it occurs in a column, in which case, given RT &gt; EF, 
	T and F must be in the same column too. Given GE &gt; HR, H must also occur in this column, 
	but this would produce 6 letters, which is too many. Therefore ERG must occur in a row.</LI>

	<LI>Given EH &gt; RI, I must occur in the same row, likewise H (GE &gt; HR). Let us now write ERGHI e.g. in the bottom row (the sequence HI is correct because of EH &gt; RI).</LI>

	<LI>We can now add a few more letters, namely DL, NX, DX, TF, ST, UA:</LI>
</UL>

<div style="text-align:center">

<TABLE cols=5 width="0*" class="pad10" ID="Table4">

<TR VALIGN="top">
<TD>*</TD>
<TD>*</TD>
<TD>*</TD>
<TD>*</TD>
<TD>*</TD>
</TR>

<TR VALIGN="top">
<TD>F</TD>
<TD>S</TD>
<TD>*</TD>
<TD>*</TD>
<TD>T</TD>
</TR>

<TR VALIGN="top">
<TD>*</TD>
<TD>*</TD>
<TD>*</TD>
<TD>A</TD>
<TD>U</TD>
</TR>

<TR VALIGN="top">
<TD>D</TD>
<TD>*</TD>
<TD>L</TD>
<TD>N</TD>
<TD>X</TD>
</TR>

<TR VALIGN="top">
<TD>R</TD>
<TD>G</TD>
<TD>H</TD>
<TD>I</TD>
<TD>E</TD>
</TR>
</TABLE><BR>

</div>



<P>Based on the known di-gram mapping AM &gt; VN we can extend the matrix, because there is only on position in the fourth row left where the character M can possibly fit: </P>

<div style="text-align:center">

<TABLE cols=5 width="0*" class="pad10" ID="Table5">

<TR VALIGN="top">
<TD>*</TD>
<TD>*</TD>
<TD>*</TD>
<TD>*</TD>
<TD>*</TD>
</TR>

<TR VALIGN="top">
<TD>F</TD>
<TD>S</TD>
<TD>*</TD>
<TD>*</TD>
<TD>T</TD>
</TR>

<TR VALIGN="top">
<TD>*</TD>
<TD>V</TD>
<TD>*</TD>
<TD>A</TD>
<TD>U</TD>
</TR>

<TR VALIGN="top">
<TD>D</TD>
<TD>M</TD>
<TD>L</TD>
<TD>N</TD>
<TD>X</TD>
</TR>

<TR VALIGN="top">
<TD>R</TD>
<TD>G</TD>
<TD>H</TD>
<TD>I</TD>
<TD>E</TD>
</TR>
</TABLE><BR>

</div>

<P>The following graphics show how a found assignment RT &gt; EF (see chapter 3.5 above) 
can be aligned:</P>

<P>a) The letters form a rectangle.</P>
<P><IMG src="images/manualplayfair_a.png" width="91%"></P>
<P>b) The letters are all in one row or one column.</P>
<P><IMG src="images/manualplayfair_b.png" width="91%"></P>

</BODY>
</HTML>
