<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" Content="text/html; charset=Windows-1252">
<TITLE>Hill encryption algorithm</TITLE>
<link rel="stylesheet" type="text/css" href="CrypTool_Help.css">
<script language="JScript" src="helper.js"></script>
</HEAD>

<!-- multiple keywords for CrypTool HTML help index -->
<OBJECT TYPE="application/x-oleobject" CLASSID="clsid:1e2a7bd0-dab9-11d0-b93a-00c04fc99f9e" VIEWASTEXT>
	<PARAM NAME="Keyword" VALUE="Symmetric">
	<PARAM NAME="Keyword" VALUE="Encryption">
	<PARAM NAME="Keyword" VALUE="Hill encryption algorithm">
</OBJECT>

<BODY>

<h3>Hill (Menu <A href="menu_crypt.html">Encrypt/Decrypt</A> \ Symmetric (classic))</h3>

<P>The Hill <!--ZZZPOPUP--><A href="verschluesselung.html">encryption algorithm</A> was invented in 1929 by Lester Hill. It was one of the first methods to make use of mathematical techniques (linear algebra), and it was hoped that this would raise the level of security.</P>

<P>The Hill encryption algorithm requires a <A href="schluessel.html">key</A> and cleartext. Also the key may only consists of the characters of the cleartext alphabet (see <A href="hidd_text_options.html">Text Options</A> dialog). Additionally the key is a quadratic matrix: this means it has the same number of rows and columns. This number is called the dimension of the matrix. The key is entered in the <A href="hidd_key_hill5x5.html">Key for Hill cipher</A> dialog.</P>

<P>The <A href="klartext.html">plaintext</A> is divided into blocks of equal size (one block consists of as many characters as the key has rows).</P>
<P>The last block sometimes has too few characters: In this case the last block is padded to have the length of the matrix dimension -- by default its filled up with the first character of the used alphabet (this character is not necessarily the one with the smallest <A href="ascii.html">ASCII</A> value, e.g. in the case when the alphabet is defined as "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"). The character used to fill the last block (paading) can be adjusted in the dialog <a href="hidd_hill_options.html">Further Hill options</a>. </P>

<P>The Hill encryption operates on the numerical values of the charcters from the selected alphabet. From a mathematics point of view, the Hill encryption algorithm is based on matrix multiplication with the matrix A=(a[i,j]) for i and j between 1 and n. In the course of this the plaintext, the encrypted text and the key are all interpreted as numbers (for example, A=0, B=1, C=2 etc.), and the interpretation depends on the sequence of the characters to be encrypted in the <A href="hidd_text_options.html">Text Options</A> dialog. If the key has dimension n x n, then a block of the encrypted text v[1]... v[n] is obtained from a block of plaintext k[1]... k[n] by applying the following formula:</P>

<P>v[j] = sum for i from 1 to n of k[i] * a[i,j], for j between 1 and n.</P>

<P>The characters of each plaintext block will be encoded to a number vector and then multiplied from the left side or the right side with the Hill matrix. The variant of the multiplication can be adjusted. If a plaintext has been encrypted with matrix A, then the encrypted text is <!--ZZZPOPUP--><A href="entschluesselung.html">decrypted</A> with the inverse matrix to the encryption matrix A <!--ZZZPOPUP--><A href="modulo.html">modulo</A> number of characters to be encrypted.  </P>

<P>Hence not all combinations of any characters could be used as keys. It makes no sense allowing a matrix that is not invertible (a matrix for which no inverse matrix exists) to be the key as decryption is then not possible. Therefore the program will reject such a key. Especially with keys of greater dimension, it is difficult to guess a key which corresponds to an invertible matrix (see the table below on this point). Therefore the pushbutton <B>Generate random key</B>in the <A href="hidd_key_hill5x5.html">Key for Hill cipher</A> generates a random key which corresponds to an invertible matrix generated.</P>

<P>In this way, the Hill encryption algorithm is a linear transformation of the plaintext. Hence it is possible to work out the key using a <!--ZZZPOPUP--><A href="knownplaintextangriff.html">Known Plaintext attack</A>. <!--ZZZPOPUP--><A href="cryptool.html">CrypTool</A> contains a tool which enables a Known Plaintext attack to be performed on <A href="hid_hill_auto.html">the Hill encryption algorithm</A>. </P>

<P>An <A href="szenarien_hill.html">example</A> of the Hill encryption algorithm and of a <!--ZZZPOPUP--><A href="knownplaintextangriff.html">Known Plaintext attack</A> will be found in the <A href="hid_hilfe_szenarien.html">Examples</A> chapter.</P>
<BR/>
<P><U>Empirical calculation of the number of invertible matrices <!--ZZZPOPUP--><A href="modulo.html">modulo</A> of different numbers:</U></P>

<P>Examples for different alphabet sizes:</P>

<P>Modulus 10: only numbers are encrypted.</P>

<P>Modulus 26: only upper or lower case letters are encrypted.</P>

<P>Modulus 52: only upper and lower case letters are encrypted.</P>

<P>Modulus 62: only upper and lower case letters and numbers are encrypted.</P>

<P>Modulus 71: only upper and lower case letters, numbers and punctuation characters are encrypted.</P>

<TABLE cols=11 width="0*" class="pad10">

<TR VALIGN="top">
<TD>Dimension:</TD>
<TD>1</TD>
<TD>2</TD>
<TD>3</TD>
<TD>4</TD>
<TD>5</TD>
<TD>6</TD>
<TD>7</TD>
<TD>8</TD>
<TD>9</TD>
<TD>10</TD>
</TR>

<TR VALIGN="top">
<TD>Modulus 4</TD>
<TD>51%</TD>
<TD>38%</TD>
<TD>33%</TD>
<TD>31%</TD>
<TD>30%</TD>
<TD>30%</TD>
<TD>29%</TD>
<TD>29%</TD>
<TD>29%</TD>
<TD>28%</TD>
</TR>

<TR VALIGN="top">
<TD>Modulus 5</TD>
<TD>81%</TD>
<TD>77%</TD>
<TD>76%</TD>
<TD>76%</TD>
<TD>76%</TD>
<TD>76%</TD>
<TD>76%</TD>
<TD>76%</TD>
<TD>76%</TD>
<TD>76%</TD>
</TR>

<TR VALIGN="top">
<TD>Modulus 6</TD>
<TD>34%</TD>
<TD>22%</TD>
<TD>19%</TD>
<TD>17%</TD>
<TD>17%</TD>
<TD>17%</TD>
<TD>16%</TD>
<TD>16%</TD>
<TD>16%</TD>
<TD>16%</TD>
</TR>

<TR VALIGN="top">
<TD>Modulus 7</TD>
<TD>86%</TD>
<TD>84%</TD>
<TD>84%</TD>
<TD>84%</TD>
<TD>84%</TD>
<TD>84%</TD>
<TD>84%</TD>
<TD>84%</TD>
<TD>84%</TD>
<TD>84%</TD>
</TR>

<TR VALIGN="top">
<TD>Modulus 10</TD>
<TD>40%</TD>
<TD>29%</TD>
<TD>25%</TD>
<TD>24%</TD>
<TD>23%</TD>
<TD>23%</TD>
<TD>22%</TD>
<TD>22%</TD>
<TD>22%</TD>
<TD>22%</TD>
</TR>

<TR VALIGN="top">
<TD>Modulus 26</TD>
<TD>46%</TD>
<TD>34%</TD>
<TD>30%</TD>
<TD>28%</TD>
<TD>27%</TD>
<TD>27%</TD>
<TD>27%</TD>
<TD>26%</TD>
<TD>26%</TD>
<TD>26%</TD>
</TR>

<TR VALIGN="top">
<TD>Modulus 35</TD>
<TD>69%</TD>
<TD>64%</TD>
<TD>64%</TD>
<TD>64%</TD>
<TD>64%</TD>
<TD>64%</TD>
<TD>64%</TD>
<TD>64%</TD>
<TD>64%</TD>
<TD>64%</TD>
</TR>

<TR VALIGN="top">
<TD>Modulus 36</TD>
<TD>33%</TD>
<TD>22%</TD>
<TD>19%</TD>
<TD>17%</TD>
<TD>16%</TD>
<TD>17%</TD>
<TD>16%</TD>
<TD>16%</TD>
<TD>16%</TD>
<TD>16%</TD>
</TR>

<TR VALIGN="top">
<TD>Modulus 52</TD>
<TD>46%</TD>
<TD>35%</TD>
<TD>30%</TD>
<TD>29%</TD>
<TD>28%</TD>
<TD>27%</TD>
<TD>27%</TD>
<TD>27%</TD>
<TD>26%</TD>
<TD>27%</TD>
</TR>

<TR VALIGN="top">
<TD>Modulus 62</TD>
<TD>49%</TD>
<TD>36%</TD>
<TD>32%</TD>
<TD>30%</TD>
<TD>29%</TD>
<TD>28%</TD>
<TD>28%</TD>
<TD>29%</TD>
<TD>27%</TD>
<TD>27%</TD>
</TR>

<TR VALIGN="top">
<TD>Modulus 71</TD>
<TD>99%</TD>
<TD>99%</TD>
<TD>99%</TD>
<TD>99%</TD>
<TD>99%</TD>
<TD>99%</TD>
<TD>99%</TD>
<TD>99%</TD>
<TD>99%</TD>
<TD>99%</TD>
</TR>
</TABLE><BR>

<P>These values suggest that the number of invertible matrices depends on the number of divisors of the modulus. <A class="filelink" onclick="parser('script-en.pdf')">Prime numbers</A> have only two divisors and a high percentage of the matrices are invertible. Moreover, the number of invertible matrices appears to become smaller as the dimension increases.</P>

</BODY>
</HTML>
